{"version":3,"file":"lib_index_js.9b49eabf628b7b47bd8a.js","mappings":"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","sources":["webpack://imjoy-jupyterlab-extension/./src/comm-connection.js","webpack://imjoy-jupyterlab-extension/./src/imjoy-extension.js","webpack://imjoy-jupyterlab-extension/./src/index.ts","webpack://imjoy-jupyterlab-extension/./src/utils.js"],"sourcesContent":["/* eslint max-classes-per-file: \"off\" */\n/* eslint no-underscore-dangle: \"off\" */\n\nfunction isSerializable(object) {\n    return typeof object === 'object' && object && object.toJSON;\n  }\n  \n  function isObject(value) {\n    return (\n      value && typeof value === 'object' && value.constructor === Object\n    );\n  }\n  \n  // pub_buffers and removeBuffers are taken from\n  // https://github.com/jupyter-widgets/ipywidgets/blob/master/packages/base/src/utils.ts\n  // Author: IPython Development Team\n  // License: BSD\n  export function putBuffers(state, bufferPaths, buffers) {\n    buffers = buffers.map(b => {\n      if (b instanceof DataView) {\n        return b.buffer;\n      }\n      return b instanceof ArrayBuffer ? b : b.buffer;\n    });\n    for (let i = 0; i < bufferPaths.length; i++) {\n      const bufferPath = bufferPaths[i];\n      // say we want to set state[x][y][z] = buffers[i]\n      let obj = state;\n      // we first get obj = state[x][y]\n      for (let j = 0; j < bufferPath.length - 1; j++) {\n        obj = obj[bufferPath[j]];\n      }\n      // and then set: obj[z] = buffers[i]\n      obj[bufferPath[bufferPath.length - 1]] = buffers[i];\n    }\n  }\n  \n  /**\n   * The inverse of putBuffers, return an objects with the new state where all buffers(ArrayBuffer)\n   * are removed. If a buffer is a member of an object, that object is cloned, and the key removed. If a buffer\n   * is an element of an array, that array is cloned, and the element is set to null.\n   * See putBuffers for the meaning of buffer_paths\n   * Returns an object with the new state (.state) an array with paths to the buffers (.buffer_paths),\n   * and the buffers associated to those paths (.buffers).\n   */\n  export function removeBuffers(state) {\n    const buffers = [];\n    const bufferPaths = [];\n    // if we need to remove an object from a list, we need to clone that list, otherwise we may modify\n    // the internal state of the widget model\n    // however, we do not want to clone everything, for performance\n    function remove(obj, path) {\n      if (isSerializable(obj)) {\n        // We need to get the JSON form of the object before recursing.\n        // See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#toJSON()_behavior\n        obj = obj.toJSON();\n      }\n      if (Array.isArray(obj)) {\n        let isCloned = false;\n        for (let i = 0; i < obj.length; i++) {\n          const value = obj[i];\n          if (value) {\n            if (\n              value instanceof ArrayBuffer ||\n              ArrayBuffer.isView(value)\n            ) {\n              if (!isCloned) {\n                obj = obj.slice();\n                isCloned = true;\n              }\n              buffers.push(\n                ArrayBuffer.isView(value) ? value.buffer : value,\n              );\n              bufferPaths.push(path.concat([i]));\n              // easier to just keep the array, but clear the entry, otherwise we have to think\n              // about array length, much easier this way\n              obj[i] = null;\n            } else {\n              const newValue = remove(value, path.concat([i]));\n              // only assigned when the value changes, we may serialize objects that don't support assignment\n              if (newValue !== value) {\n                if (!isCloned) {\n                  obj = obj.slice();\n                  isCloned = true;\n                }\n                obj[i] = newValue;\n              }\n            }\n          }\n        }\n      } else if (isObject(obj)) {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const key of Object.keys(obj)) {\n          let isCloned = false;\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            const value = obj[key];\n            if (value) {\n              if (\n                value instanceof ArrayBuffer ||\n                ArrayBuffer.isView(value)\n              ) {\n                if (!isCloned) {\n                  obj = {\n                    ...obj,\n                  };\n                  isCloned = true;\n                }\n                buffers.push(\n                  ArrayBuffer.isView(value) ? value.buffer : value,\n                );\n                bufferPaths.push(path.concat([key]));\n                delete obj[key]; // for objects/dicts we just delete them\n              } else {\n                const newValue = remove(value, path.concat([key]));\n                // only assigned when the value changes, we may serialize objects that don't support assignment\n                if (newValue !== value) {\n                  if (!isCloned) {\n                    obj = {\n                      ...obj,\n                    };\n                    isCloned = true;\n                  }\n                  obj[key] = newValue;\n                }\n              }\n            }\n          }\n        }\n      }\n      return obj;\n    }\n    const newState = remove(state, []);\n    return {\n      state: newState,\n      buffers,\n      buffer_paths: bufferPaths,\n    };\n  }\n  \n  class MessageEmitter {\n    constructor(debug) {\n      this._event_handlers = {};\n      this._once_handlers = {};\n      this._debug = debug;\n    }\n  \n    emit() {\n      throw new Error('emit is not implemented');\n    }\n  \n    on(event, handler) {\n      if (!this._event_handlers[event]) {\n        this._event_handlers[event] = [];\n      }\n      this._event_handlers[event].push(handler);\n    }\n  \n    once(event, handler) {\n      handler.___event_run_once = true;\n      this.on(event, handler);\n    }\n  \n    off(event, handler) {\n      if (!event && !handler) {\n        // remove all events handlers\n        this._event_handlers = {};\n      } else if (event && !handler) {\n        // remove all hanlders for the event\n        if (this._event_handlers[event])\n          this._event_handlers[event] = [];\n      } else if (this._event_handlers[event]) {\n        // remove a specific handler\n        const idx = this._event_handlers[event].indexOf(handler);\n        if (idx >= 0) {\n          this._event_handlers[event].splice(idx, 1);\n        }\n      }\n    }\n  \n    _fire(event, data) {\n      if (this._event_handlers[event]) {\n        let i = this._event_handlers[event].length;\n        while (i--) {\n          const handler = this._event_handlers[event][i];\n          try {\n            handler(data);\n          } catch (e) {\n            console.error(e);\n          } finally {\n            if (handler.___event_run_once) {\n              this._event_handlers[event].splice(i, 1);\n            }\n          }\n        }\n      } else if (this._debug) {\n        console.warn('unhandled event', event, data);\n      }\n    }\n  }\n  \n  export class Connection extends MessageEmitter {\n    constructor(config) {\n      super(config && config.debug);\n      const comm = config.kernel.createComm('imjoy_rpc');\n      comm.open({});\n      comm.onMsg = msg => {\n        const { data } = msg.content;\n        const bufferPaths = data.__buffer_paths__ || [];\n        delete data.__buffer_paths__;\n        putBuffers(data, bufferPaths, msg.buffers || []);\n        if (data.type === 'log' || data.type === 'info') {\n          console.log(data.message);\n        } else if (data.type === 'error') {\n          console.error(data.message);\n        } else {\n          if (data.peer_id) {\n            this._peer_id = data.peer_id;\n          }\n          this._fire(data.type, data);\n        }\n      };\n      this.comm = comm;\n    }\n  \n    connect() {}\n  \n    disconnect() {}\n  \n    emit(data) {\n      data.peer_id = this._peer_id;\n      const split = removeBuffers(data);\n      split.state.__buffer_paths__ = split.buffer_paths;\n      // NOTE: updated for newer kernels, the send signature is different\n      this.comm.send(split.state, null, split.buffers);\n    }\n  }\n      ","/**\n * Initialization data for the imjoy-jupyterlab-extension extension.\n */\n\nimport { loadImJoyBasicApp } from \"imjoy-core/dist/imjoy-loader\";\nimport { setupRPC } from \"imjoy-core/dist/imjoy-rpc\";\nimport { githubUrlRaw, convertZenodoFileUrl } from \"./utils.js\";\nimport \"reflect-metadata\";\n\nimport {\n  showErrorMessage, Spinner\n} from '@jupyterlab/apputils';\nimport { PathExt } from '@jupyterlab/coreutils';\n\nimport { DisposableDelegate } from '@lumino/disposable';\n\nimport { ToolbarButton } from '@jupyterlab/apputils';\n\n// import { version } from '../package.json';\n\nimport { Connection } from './comm-connection.js';\n\n\nasync function patchPyodideKernel(kernel){\n  const info = await kernel.info;\n  // apply patch for pyolite to make sure we have the kernel id\n  if(info.implementation === 'pyodide') {\n    const kernel_patch = `\nimport os\nimport ipykernel\nimport micropip\nimport sys\nawait micropip.install([ \"imjoy-rpc\"])\nimport imjoy_rpc\nif 'imjoy' not in sys.modules:\n    sys.modules['imjoy'] = sys.modules['imjoy_rpc']\nif 'IMJOY_RPC_CONNECTION' not in os.environ:\n    os.environ['IMJOY_RPC_CONNECTION'] = 'jupyter'\nclass Connect():\n    def __init__(self, kernel_id):\n        self.kernel_id = kernel_id\n    def get_connection_file(self):\n        return f\"kernel-{self.kernel_id}.json\"\nif not hasattr(ipykernel, 'connect'):\n    ipykernel.connect = Connect(\"${kernel.id}\")\n`;\n    const future = kernel.requestExecute({ code: kernel_patch } );\n    await future.done\n    console.log('Pyodide kernel patch applied');\n\n  }\n}\n\nexport async function parseURL(queryString, app, browser, trans){\n  const urlParams = new URLSearchParams(queryString);\n  const urls = urlParams.getAll(\"load\");\n  let lastFile = null;\n  for(let url of urls){\n    let type = '';\n    let blob;\n    // fetch the file from the URL\n    try {\n      if (url.includes(\"//zenodo.org/record\")) {\n          url = await convertZenodoFileUrl(url);\n      } else {\n        url = await githubUrlRaw(url, \".ipynb\") || url;\n      }\n      const req = await fetch(url);\n      blob = await req.blob();\n      type = req.headers.get('Content-Type') ?? '';\n        // upload the content of the file to the server\n      try {\n        const name = PathExt.basename(url).split(\"?\")[0];\n        const file = new File([blob], name, { type });\n        const model = await browser.model.upload(file);\n        lastFile = model.path\n        console.log(\"File uploaded: \" + model.path);\n      } catch (error) {\n        showErrorMessage(\n          trans._p('showErrorMessage', 'Upload Error'),\n          error\n        );\n      }\n    } catch (reason) {\n      if (reason.response && reason.response.status !== 200) {\n        reason.message = trans.__('Could not open URL: %1', url);\n      }\n      return showErrorMessage(trans.__('Cannot fetch'), reason);\n    }\n  }\n\n  let file2Open = urlParams.get(\"open\") \n  if(file2Open === \"1\" ) file2Open = lastFile;\n  if(file2Open){\n    await app.commands.execute('docmanager:open', {\n      path: file2Open\n    });\n  }\n}\n\nexport class ImjoyExtension {\n  constructor(jupyterBaseUrl, labApp, fileBrowser) {\n    this.baseUrl = jupyterBaseUrl;\n    const isIframe = window.self !== window.top;\n    this.notebookHandlerPromise = new Promise((resolve, reject) => {\n      this.resolveNotebookHandler = resolve;\n      this.rejectNotebookHandler = reject;\n    })\n    // create an div with id= \"window-container\"\n    const container = document.createElement('div');\n    container.id = 'window-container';\n    document.body.appendChild(container)\n    let imjoy;\n    loadImJoyBasicApp({\n        process_url_query: true,\n        show_window_title: false,\n        show_progress_bar: true,\n        show_empty_window: true,\n        menu_style: { position: \"absolute\", right: 0, top: \"2px\" },\n        window_style: {width: '100%', height: '100%'},\n        main_container: null,\n        menu_container: null,\n        expose_api: false, // expose api to the iframe\n        // window_manager_container: \"window-container\",\n        imjoy_api: {\n          async createWindow(_plugin, w, extra_config) {\n            if (!document.getElementById(w.window_id)) {\n              if (!w.dialog) {\n                if (document.getElementById(_plugin.id)) {\n                  const elem = document.createElement('div');\n                  elem.id = w.window_id;\n                  elem.classList.add('imjoy-inline-window');\n                  document.getElementById(_plugin.id).appendChild(elem);\n                }\n              }\n            }\n            return await imjoy.pm.createWindow(_plugin, w, extra_config);\n          },\n        }\n    }).then(async app=>{\n      console.log(`ImJoy Basic App loaded!`)\n      imjoy = app.imjoy;\n      const kernelInfo = {}\n      if(isIframe){\n        const api = await setupRPC({ name: \"JupyterLite\" });\n        api.export({\n          setup(){\n          },\n          run(ctx){\n            ctx = ctx || {}\n            ctx.config = ctx.config || {}\n            ctx.config.left_collapsed = ctx.config.left_collapsed === undefined ? true:false\n            if(ctx.config.left_collapsed){\n              if(!labApp.shell.leftCollapsed){\n                labApp.commands.execute('application:toggle-left-area');\n              }\n            }\n            else{\n              if(labApp.shell.leftCollapsed){\n                labApp.commands.execute('application:toggle-left-area');\n              }\n            }\n          },\n          async fileExists(path){\n            try{\n              await fileBrowser.model.manager.services.contents.get(path);\n              return true;\n            }\n            catch(e){\n              return false;\n            }\n          },  \n          async getFile(path){\n            return await fileBrowser.model.manager.services.contents.get(path);\n          },\n          async removeFile(path){\n            return await fileBrowser.model.manager.deleteFile(path);\n          },\n          async loadFile(name, content, type){\n            const file = new File([content], name, { type });\n            const model = await fileBrowser.model.upload(file);\n            return model.path;\n          },\n          async openFile(path){\n            await labApp.commands.execute('docmanager:open', {\n              path: path\n            });\n          },\n          async closeLeft(){\n            if(!labApp.shell.leftCollapsed){\n              labApp.commands.execute('application:toggle-left-area');\n            }\n          },\n          async openLeft(){\n            if(labApp.shell.leftCollapsed){\n              labApp.commands.execute('application:toggle-left-area');\n            }\n          }\n        })\n      }\n\n      async function connectPlugin(kernel_id) {\n        if (!kernelInfo[kernel_id]) {\n          console.warn('Kernel is not ready: ' + kernel_id);\n          return;\n        }\n        const kernel = kernelInfo[kernel_id].kernel;\n        await kernel.ready;\n        const plugin = await imjoy.pm.connectPlugin(\n          new Connection({ kernel }),\n        );\n        kernelInfo[kernel_id].plugin = plugin;\n      }\n\n      async function runNotebookPlugin(kernel_id) {\n        if (!kernelInfo[kernel_id]) {\n          console.warn('Kernel is not ready: ' + kernel_id);\n          return;\n        }\n        try {\n          const plugin = kernelInfo[kernel_id].plugin;\n          if (plugin && plugin.api.run) {\n            let config = {};\n            if (\n              plugin.config.ui &&\n              plugin.config.ui.indexOf('{') > -1\n            ) {\n              config = await app.imjoy.pm.imjoy_api.showDialog(\n                plugin,\n                plugin.config,\n              );\n            }\n            await plugin.api.run({\n              config: config,\n              data: {},\n            });\n          }\n        } catch (e) {\n          console.error(e);\n          app.showMessage(`Failed to load the plugin, error: ${e}`);\n        }\n      }\n      window.connectPlugin = async kernel_id => {\n        if (!kernel_id) {\n          console.warn(\n            'Please upgrade imjoy-rpc(>=0.3.35) by running `pip install -U imjoy-rpc`',\n          );\n          return;\n        }\n        await connectPlugin(kernel_id);\n        await runNotebookPlugin(kernel_id);\n      };\n      window._connectPlugin = async kernel_id => {\n        await connectPlugin(kernel_id);\n      };\n      window._runPluginOnly = async kernel_id => {\n        await runNotebookPlugin(kernel_id);\n      };\n\n      this.resolveNotebookHandler(async (sessionContext, panelNode, buttonNode)=>{\n        const { kernel } = sessionContext.session;\n        buttonNode.style.minWidth = \"25px\";\n        const _spinner = new Spinner();\n        _spinner.node.firstChild.style.width = \"20px\";\n        _spinner.node.firstChild.style.height = \"20px\";\n        sessionContext.kernelChanged.connect(() => {\n          buttonNode.appendChild(_spinner.node);\n          patchPyodideKernel(kernel).finally(()=>{\n            buttonNode.removeChild(_spinner.node);\n          }).catch(()=>{\n            console.error(\"Failed to apply pyodide patch\");\n          })\n        }, sessionContext);\n        buttonNode.appendChild(_spinner.node);\n        try{\n          await patchPyodideKernel(kernel);\n        }\n        catch(e){\n          throw e;\n        }\n        finally{\n          buttonNode.removeChild(_spinner.node);\n        }\n        kernelInfo[kernel._id] = { kernel };\n        buttonNode.firstChild.innerHTML = `<img src=\"https://imjoy.io/static/img/imjoy-logo-black.svg\" style=\"height: 17px;\">`;\n        buttonNode.firstChild.onclick = () => {\n          runNotebookPlugin(kernel._id);\n        };\n      })\n    })\n    .catch(e => {\n      console.error(e);\n      this.rejectNotebookHandler(e);\n    });\n  }\n\n  /**\n   * Create a new extension object.\n   */\n  createNew(panel, context) {\n    const button = new ToolbarButton({\n      tooltip: `ImJoy JupyterLab Extension`, // (version: ${version})`,\n    });\n    panel.toolbar.insertItem(0, 'Run ImJoy Plugin', button);\n\n    context.sessionContext.ready.then(async () => {\n      const notebookHandler = await this.notebookHandlerPromise;\n      notebookHandler(context.sessionContext, panel.node, button.node);\n    });\n    return new DisposableDelegate(() => {\n      button.dispose();\n    });\n  }\n}\n","import {\n  JupyterFrontEnd,\n  JupyterFrontEndPlugin\n} from '@jupyterlab/application';\nimport {\n  IFileBrowserFactory\n} from '@jupyterlab/filebrowser';\nimport { ITranslator } from '@jupyterlab/translation';\nimport { ImjoyExtension, parseURL } from './imjoy-extension.js';\n/**\n * Initialization data for the imjoy-jupyterlab-extension extension.\n */\n\nconst plugin: JupyterFrontEndPlugin<void> =  {\n  id: 'imjoy-jupyterlab-extension',\n  requires: [IFileBrowserFactory, ITranslator],\n  autoStart: true,\n  activate: async function (app: JupyterFrontEnd, factory:IFileBrowserFactory, translator: ITranslator) {\n    const trans = translator.load('jupyterlab');\n    // const { defaultBrowser: browser } = factory;\n    // Manually restore and load the default file browser.\n    const browser = factory.createFileBrowser('filebrowser', {\n      auto: false,\n      restore: false\n    });\n\n    const jupyterBaseUrl = app.serviceManager.settings.serverSettings.baseUrl;\n    app.docRegistry.addWidgetExtension(\n      'Notebook',\n      new ImjoyExtension(jupyterBaseUrl, app, browser),\n    );\n    console.log(\n      'JupyterLab extension imjoy-jupyterlab-extension is activated!'\n    );\n    const currentLocation = new URL(window.location.href);\n    app.started.then(() => {\n      parseURL(currentLocation.search, app, browser, trans).finally(() => {\n        // restore location, since jupyterlab will force double slashes into single\n        window.history.pushState(null, '', currentLocation.href);\n      });\n    });\n  }\n}\n\nexport default plugin;","// from https://github.com/segmentio/is-url\n/**\n * RegExps.\n * A URL must match #1 and then at least one of #2/#3.\n * Use two levels of REs to avoid REDOS.\n */\n\nconst protocolAndDomainRE = /^(?:\\w+:)?\\/\\/([\\s\\S]+)$/;\n\nconst localhostDomainRE = /^localhost[\\:?\\d]*(?:[^\\:?\\d][\\s\\S]*)?$/;\nconst nonLocalhostDomainRE = /^[^\\s\\.]+\\.[\\s\\S]{2,}$/;\n\n/**\n * Loosely validate a URL `string`.\n *\n * @param {String} string\n * @return {Boolean}\n */\n\nexport function isUrl(string) {\n  if (typeof string !== \"string\") {\n    return false;\n  }\n\n  var match = string.match(protocolAndDomainRE);\n  if (!match) {\n    return false;\n  }\n\n  var everythingAfterProtocol = match[1];\n  if (!everythingAfterProtocol) {\n    return false;\n  }\n\n  if (\n    localhostDomainRE.test(everythingAfterProtocol) ||\n    nonLocalhostDomainRE.test(everythingAfterProtocol)\n  ) {\n    return true;\n  }\n\n  return false;\n}\n\n//from: https://github.com/github-modules/github-url-to-object/blob/master/index.js\nconst laxUrlRegex = /(?:(?:[^:]+:)?[/][/])?(?:.+@)?([^/]+)([/][^?#]+)/;\n\nexport function githubUrlToObject(repoUrl, opts) {\n  var obj = {};\n  opts = opts || {};\n\n  if (!repoUrl) return null;\n\n  // Allow an object with nested `url` string\n  // (common practice in package.json files)\n  if (repoUrl.url) repoUrl = repoUrl.url;\n\n  if (typeof repoUrl !== \"string\") return null;\n\n  var shorthand = repoUrl.match(/^([\\w-_]+)\\/([\\w-_\\.]+)(?:#([\\w-_\\.]+))?$/);\n  var mediumhand = repoUrl.match(\n    /^github:([\\w-_]+)\\/([\\w-_\\.]+)(?:#([\\w-_\\.]+))?$/\n  );\n  var antiquated = repoUrl.match(/^git@[\\w-_\\.]+:([\\w-_]+)\\/([\\w-_\\.]+)$/);\n\n  if (shorthand) {\n    obj.user = shorthand[1];\n    obj.repo = shorthand[2];\n    obj.branch = shorthand[3] || \"master\";\n    obj.host = \"github.com\";\n  } else if (mediumhand) {\n    obj.user = mediumhand[1];\n    obj.repo = mediumhand[2];\n    obj.branch = mediumhand[3] || \"master\";\n    obj.host = \"github.com\";\n  } else if (antiquated) {\n    obj.user = antiquated[1];\n    obj.repo = antiquated[2].replace(/\\.git$/i, \"\");\n    obj.branch = \"master\";\n    obj.host = \"github.com\";\n  } else {\n    // Turn git+http URLs into http URLs\n    repoUrl = repoUrl.replace(/^git\\+/, \"\");\n\n    if (!isUrl(repoUrl)) return null;\n\n    const [, hostname, pathname] = repoUrl.match(laxUrlRegex) || [];\n    if (!hostname) return null;\n    if (\n      hostname !== \"github.com\" &&\n      hostname !== \"www.github.com\" &&\n      !opts.enterprise\n    )\n      return null;\n\n    var parts = pathname.match(\n      /^\\/([\\w-_]+)\\/([\\w-_\\.]+)(\\/tree\\/[\\w-_\\.\\/]+)?(\\/blob\\/[\\s\\w-_\\.\\/]+)?/\n    );\n    // ([\\w-_\\.]+)\n    if (!parts) return null;\n    obj.user = parts[1];\n    obj.repo = parts[2].replace(/\\.git$/i, \"\");\n\n    obj.host = hostname || \"github.com\";\n\n    if (parts[3] && /^\\/tree\\/master\\//.test(parts[3])) {\n      obj.branch = \"master\";\n      obj.path = parts[3].replace(/\\/$/, \"\");\n    } else if (parts[3]) {\n      obj.branch = parts[3]\n        .replace(/^\\/tree\\//, \"\")\n        .match(/[\\w-_.]+\\/{0,1}[\\w-_]+/)[0];\n    } else if (parts[4]) {\n      obj.branch = parts[4]\n        .replace(/^\\/blob\\//, \"\")\n        .match(/[\\w-_.]+\\/{0,1}[\\w-_]+/)[0];\n    } else {\n      obj.branch = \"master\";\n    }\n  }\n\n  if (obj.host === \"github.com\") {\n    obj.apiHost = \"api.github.com\";\n  } else {\n    obj.apiHost = `${obj.host}/api/v3`;\n  }\n\n  obj.tarball_url = `https://${obj.apiHost}/repos/${obj.user}/${obj.repo}/tarball/${obj.branch}`;\n  obj.clone_url = `https://${obj.host}/${obj.user}/${obj.repo}`;\n\n  if (obj.branch === \"master\") {\n    obj.https_url = `https://${obj.host}/${obj.user}/${obj.repo}`;\n    obj.travis_url = `https://travis-ci.org/${obj.user}/${obj.repo}`;\n    obj.zip_url = `https://${obj.host}/${obj.user}/${obj.repo}/archive/master.zip`;\n  } else {\n    obj.https_url = `https://${obj.host}/${obj.user}/${obj.repo}/blob/${obj.branch}`;\n    obj.travis_url = `https://travis-ci.org/${obj.user}/${obj.repo}?branch=${obj.branch}`;\n    obj.zip_url = `https://${obj.host}/${obj.user}/${obj.repo}/archive/${obj.branch}.zip`;\n  }\n\n  // Support deep paths (like lerna-style repos)\n  if (obj.path) {\n    obj.https_url += obj.path;\n  }\n\n  obj.api_url = `https://${obj.apiHost}/repos/${obj.user}/${obj.repo}`;\n\n  return obj;\n}\n\n// from: https://github.com/Elixirdoc/github-url-raw\nexport async function githubUrlRaw(url, extFilter) {\n  if (url.includes(\"gist.github.com\")) {\n    const gistId = url.split(\"/\").slice(-1)[0];\n    const blob = await fetch(\"https://api.github.com/gists/\" + gistId).then(r =>\n      r.blob()\n    );\n    const data = JSON.parse(await new Response(blob).text());\n    // TODO: handle multiple files, e.g.: display them all\n    if (extFilter) {\n      const selected_file = Object.values(data.files).filter(file => {\n        return file.filename.endsWith(extFilter);\n      })[0];\n      return selected_file && selected_file.raw_url;\n    } else return data.files[Object.values(data.files)[0]].raw_url;\n  }\n  if (!url.includes(\"blob\") || !url.includes(\"github\")) {\n    return null;\n  }\n  var ghObj = githubUrlToObject(url);\n  var githubUser = ghObj.user;\n  var githubRepo = ghObj.repo;\n  // var githubBranch = ghObj.branch;\n  var re = new RegExp(\n    \"^https://github.com/\" + githubUser + \"/\" + githubRepo + \"/blob/\",\n    \"g\"\n  );\n  var regStr = url.replace(re, \"\");\n\n  return (\n    \"https://raw.githubusercontent.com/\" +\n    githubUser +\n    \"/\" +\n    githubRepo +\n    \"/\" +\n    regStr\n  );\n}\n\nexport async function convertZenodoFileUrl(url) {\n  const myRegexp = /https?:\\/\\/zenodo.org\\/record\\/([a-zA-Z0-9-]+)\\/files\\/(.*)/g;\n  const match = myRegexp.exec(url);\n  if (!match || match.length !== 3) {\n    throw new Error(\"Invalid zenodo url\");\n  }\n  const [fullUrl, depositId, fileName] = match;\n  const blob = await fetch(\n    `https://zenodo.org/api/records/${depositId}`\n  ).then(r => r.blob());\n  const data = JSON.parse(await new Response(blob).text());\n  const fn = fileName.split(\"?\")[0];\n  const fileObj = data.files.filter(file => {\n    return file.key === fn;\n  })[0];\n  return fileObj.links.self;\n}\n"],"names":[],"sourceRoot":""}