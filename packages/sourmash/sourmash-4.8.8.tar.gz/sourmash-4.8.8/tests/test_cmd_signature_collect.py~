"""
Tests for 'sourmash sig collect'
"""

import sourmash_tst_utils as utils
import sourmash_tst_utils as utils
import sourmash

def test_sig_manifest_1_zipfile(runtmp):
    # make a manifest from a .zip file
    protzip = utils.get_test_data('prot/protein.zip')
    runtmp.sourmash('sig', 'manifest', protzip, '-o', 'SOURMASH-MANIFEST.csv')

    manifest_fn = runtmp.output('SOURMASH-MANIFEST.csv')
    with open(manifest_fn, newline='') as csvfp:
        manifest = CollectionManifest.load_from_csv(csvfp)

    assert len(manifest) == 2
    md5_list = [ row['md5'] for row in manifest.rows ]
    assert '16869d2c8a1d29d1c8e56f5c561e585e' in md5_list
    assert '120d311cc785cc9d0df9dc0646b2b857' in md5_list


