"use strict";(self.webpackChunkmlflow_oidc_auth_front=self.webpackChunkmlflow_oidc_auth_front||[]).push([[871],{6871:(oe,A,r)=>{r.r(A),r.d(A,{AdminPageModule:()=>ne});var f=r(6895),v=r(4006),c=r(9197),p=r(3732),l=r(3900),g=r(9300),m=(()=>{return(i=m||(m={})).EDIT="EDIT",i.DELETE="DELETE",i.REVOKE="REVOKE",i.ADD="ADD",i.MANAGE="MANAGE",m;var i})();const u={ADD:{name:"Add",icon:"add",action:m.ADD},EDIT:{name:"Edit",icon:"edit",action:m.EDIT},DELETE:{name:"Delete",icon:"delete",action:m.DELETE},REVOKE:{name:"Revoke",icon:"key_off",action:m.REVOKE}};var E=r(2590);const x=[u.EDIT,u.REVOKE],b=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];var e=r(4650),_=r(5938),d=r(1299),h=r(6709),T=r(7392),P=r(4859);let N=(()=>{class i{constructor(t,n,s,a,C){this.dialog=t,this.experimentDataService=n,this.permissionDataService=s,this.userDataService=a,this.route=C,this.userColumnConfig=b,this.actions=x,this.userDataSource=[]}ngOnInit(){this.experimentId=this.route.snapshot.paramMap.get("id")??"",this.experimentDataService.getUsersForExperiment(this.experimentId).subscribe(t=>{this.userDataSource=t})}handleUserEdit(t){this.dialog.open(p.jA,{data:{userName:t.username,entityName:this.experimentId,entityType:E.W.EXPERIMENT,permission:t.permission}}).afterClosed().pipe((0,l.w)(s=>this.permissionDataService.updateExperimentPermission({user_name:t.username,experiment_id:this.experimentId,new_permission:s.permission}))).subscribe(s=>{console.log(s)})}handleActions(t){const s={[m.EDIT]:this.handleUserEdit.bind(this),[m.REVOKE]:this.revokePermissionForUser.bind(this)}[t.action.action];s&&s(t.item)}revokePermissionForUser(t){this.permissionDataService.deleteExperimentPermission({experiment_id:this.experimentId,user_name:t.username}).subscribe(console.log)}addUser(){this.userDataService.getAllUsers().pipe((0,l.w)(({users:t})=>this.dialog.open(p.LP,{data:{users:t}}).afterClosed()),(0,g.h)(Boolean),(0,l.w)(({user:t,permission:n})=>this.permissionDataService.createExperimentPermission({experiment_id:this.experimentId,new_permission:n,user_name:t})),(0,l.w)(()=>this.loadUsersForExperiment(this.experimentId))).subscribe(t=>{this.userDataSource=t})}loadUsersForExperiment(t){return this.experimentDataService.getUsersForExperiment(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.uw),e.Y36(d.jR),e.Y36(d.PQ),e.Y36(d.Mn),e.Y36(c.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-experiment-permission-details"]],decls:10,vars:3,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3,"Experiment Access"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return n.addUser()}),e.TgZ(5,"mat-icon"),e._uU(6,"add"),e.qZA(),e.TgZ(7,"span"),e._uU(8,"Add"),e.qZA()()(),e.TgZ(9,"ml-table",3),e.NdJ("action",function(a){return n.handleActions(a)}),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("columnConfig",n.userColumnConfig)("data",n.userDataSource)("actions",n.actions))},dependencies:[h.a,T.Hw,P.lW]}),i})();var O=r(8505);const Z=[u.EDIT,u.REVOKE],y=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];function F(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"ml-table",4),e.NdJ("action",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.handleActions(s))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("columnConfig",t.userColumnConfig)("data",t.userDataSource)("actions",t.actions)}}let w=(()=>{class i{constructor(t,n,s,a,C,se){this.dialog=t,this.route=n,this.modelDataService=s,this.permissionDataService=a,this.userDataService=C,this.snackService=se,this.userDataSource=[],this.userColumnConfig=y,this.actions=Z}ngOnInit(){this.modelId=this.route.snapshot.paramMap.get("id")??"",this.loadUsersForModel(this.modelId).subscribe(t=>{this.userDataSource=t})}revokePermissionForUser(t){this.permissionDataService.deleteModelPermission({model_name:this.modelId,user_name:t.username}).subscribe(console.log)}editPermissionForUser({username:t,permission:n}){this.dialog.open(p.jA,{data:{userName:t,entityName:this.modelId,entityType:E.W.MODEL,permission:n}}).afterClosed().pipe((0,g.h)(Boolean),(0,l.w)(({permission:a})=>this.permissionDataService.updateModelPermission({model_name:this.modelId,new_permission:a,user_name:t})),(0,O.b)(()=>this.snackService.openSnackBar("Permission updated")),(0,l.w)(()=>this.loadUsersForModel(this.modelId))).subscribe(a=>{this.userDataSource=a})}handleActions({action:t,item:n}){const a={[m.REVOKE]:this.revokePermissionForUser.bind(this),[m.EDIT]:this.editPermissionForUser.bind(this)}[t.action];a&&a(n)}loadUsersForModel(t){return this.modelDataService.getUsersForModel(t)}addUser(){this.userDataService.getAllUsers().pipe((0,l.w)(({users:t})=>this.dialog.open(p.LP,{data:{users:t}}).afterClosed()),(0,g.h)(Boolean),(0,l.w)(({user:t,permission:n})=>this.permissionDataService.createModelPermission({model_name:this.modelId,new_permission:n,user_name:t})),(0,l.w)(()=>this.loadUsersForModel(this.modelId))).subscribe(t=>{this.userDataSource=t})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.uw),e.Y36(c.gz),e.Y36(d.$N),e.Y36(d.PQ),e.Y36(d.Mn),e.Y36(d.cw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-model-permission-details"]],decls:10,vars:1,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action",4,"ngIf"],[3,"columnConfig","data","actions","action"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3,"Experiment Access"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return n.addUser()}),e.TgZ(5,"mat-icon"),e._uU(6,"add"),e.qZA(),e.TgZ(7,"span"),e._uU(8,"Add"),e.qZA()()(),e.YNc(9,F,1,3,"ml-table",3),e.qZA()),2&t&&(e.xp6(9),e.Q6J("ngIf",n.userDataSource.length))},dependencies:[f.O5,h.a,T.Hw,P.lW]}),i})();var Y=r(4128);const L=[{title:"Model name",key:"name"},{title:"Permissions",key:"permissions"}],J=[{title:"Experiment Name",key:"name"},{title:"Permission",key:"permissions"}];var D=r(3848);function R(i,o){if(1&i&&e._UZ(0,"ml-table",6),2&i){const t=e.oxw();e.Q6J("columnConfig",t.experimentsColumnConfig)("data",t.experimentsDataSource)}}function k(i,o){if(1&i&&e._UZ(0,"ml-table",6),2&i){const t=e.oxw();e.Q6J("columnConfig",t.modelsColumnConfig)("data",t.modelsDataSource)}}let B=(()=>{class i{constructor(t,n,s,a,C){this.dialog=t,this.expDataService=n,this.modelDataService=s,this.permissionDataService=a,this.route=C,this.userId="",this.experimentsColumnConfig=J,this.modelsColumnConfig=L,this.experimentsDataSource=[],this.modelsDataSource=[]}ngOnInit(){this.userId=this.route.snapshot.paramMap.get("id")??"",(0,Y.D)([this.expDataService.getExperimentsForUser(this.userId),this.modelDataService.getModelsForUser(this.userId)]).subscribe(([t,n])=>{this.experimentsDataSource=t,this.modelsDataSource=n})}addModelPermissionToUser(){this.modelDataService.getAllModels().pipe((0,l.w)(t=>this.dialog.open(p.Rt,{data:{entityType:E.W.MODEL,entities:t.map(({name:n})=>n),userName:this.userId}}).afterClosed()),(0,g.h)(Boolean),(0,l.w)(({entity:t,permission:n})=>this.permissionDataService.createModelPermission({user_name:this.userId,model_name:t,new_permission:n}))).subscribe()}addExperimentPermissionToUser(){this.expDataService.getAllExperiments().pipe((0,l.w)(t=>this.dialog.open(p.Rt,{data:{entityType:E.W.EXPERIMENT,entities:t.map(({name:n})=>n),userName:this.userId}}).afterClosed()),(0,g.h)(Boolean),(0,l.w)(({entity:t,permission:n})=>this.permissionDataService.createExperimentPermission({user_name:this.userId,experiment_name:t,new_permission:n}))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.uw),e.Y36(d.jR),e.Y36(d.$N),e.Y36(d.PQ),e.Y36(c.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-user-permission-details"]],decls:19,vars:2,consts:[["label","Experiments"],[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data",4,"ngIf"],["label","Models"],[3,"columnConfig","data"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-tab-group")(1,"mat-tab",0)(2,"div",1)(3,"div",2)(4,"button",3),e.NdJ("click",function(){return n.addExperimentPermissionToUser()}),e.TgZ(5,"mat-icon"),e._uU(6,"add"),e.qZA(),e.TgZ(7,"span"),e._uU(8,"Add"),e.qZA()()(),e.YNc(9,R,1,2,"ml-table",4),e.qZA()(),e.TgZ(10,"mat-tab",5)(11,"div",1)(12,"div",2)(13,"button",3),e.NdJ("click",function(){return n.addModelPermissionToUser()}),e.TgZ(14,"mat-icon"),e._uU(15,"add"),e.qZA(),e.TgZ(16,"span"),e._uU(17,"Add"),e.qZA()()(),e.YNc(18,k,1,2,"ml-table",4),e.qZA()()()),2&t&&(e.xp6(9),e.Q6J("ngIf",n.experimentsDataSource.length),e.xp6(9),e.Q6J("ngIf",n.modelsDataSource.length))},dependencies:[f.O5,h.a,T.Hw,P.lW,D.SP,D.uX],styles:[".header-section[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:36px}.header-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;padding:0}"]}),i})(),Q=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-admin-page"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[c.lC],encapsulation:2}),i})();const X=[{title:"User name",key:"user"}],G=[u.EDIT];let K=(()=>{class i{constructor(t,n,s){this.router=t,this.route=n,this.userDataService=s,this.columnConfig=X,this.actions=G,this.dataSource=[]}ngOnInit(){this.userDataService.getAllUsers().subscribe(({users:t})=>this.dataSource=t.map(n=>({user:n})))}handleItemAction({action:t,item:n}){const a={[m.EDIT]:this.handleUserEdit.bind(this)}[t.action];a&&a(n)}handleUserEdit({user:t}){this.router.navigate(["../user/"+t],{relativeTo:this.route})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.F0),e.Y36(c.gz),e.Y36(d.Mn))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-user-permissions"]],decls:1,vars:3,consts:[[3,"columnConfig","data","actions","action"]],template:function(t,n){1&t&&(e.TgZ(0,"ml-table",0),e.NdJ("action",function(a){return n.handleItemAction(a)}),e.qZA()),2&t&&e.Q6J("columnConfig",n.columnConfig)("data",n.dataSource)("actions",n.actions)},dependencies:[h.a]}),i})();const z=[{action:m.EDIT,icon:"edit",name:"Edit"}],V=[{title:"Experiment Name",key:"name"}];let j=(()=>{class i{constructor(t,n,s){this.router=t,this.route=n,this.experimentDataService=s,this.columnConfig=V,this.dataSource=[],this.actions=z}ngOnInit(){this.experimentDataService.getAllExperiments().subscribe(t=>this.dataSource=t)}handleActions(t){const s={[m.EDIT]:this.handleExperimentEdit.bind(this)}[t.action.action];s&&s(t.item)}handleExperimentEdit({id:t}){this.router.navigate(["../experiment/"+t],{relativeTo:this.route})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.F0),e.Y36(c.gz),e.Y36(d.jR))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-experiment-permissions"]],decls:1,vars:3,consts:[[3,"columnConfig","data","actions","action"]],template:function(t,n){1&t&&(e.TgZ(0,"ml-table",0),e.NdJ("action",function(a){return n.handleActions(a)}),e.qZA()),2&t&&e.Q6J("columnConfig",n.columnConfig)("data",n.dataSource)("actions",n.actions)},dependencies:[h.a]}),i})();const H=[{title:"Model Name",key:"name"}],W=[u.EDIT];function q(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"ml-table",1),e.NdJ("action",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.handleAction(s))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("columnConfig",t.columnConfig)("data",t.dataSource)("actions",t.actions)}}let $=(()=>{class i{constructor(t,n,s){this.route=t,this.router=n,this.modelDataService=s,this.columnConfig=H,this.dataSource=[],this.actions=W}ngOnInit(){this.modelDataService.getAllModels().subscribe(t=>{this.dataSource=t})}handleModelEdit({name:t}){this.router.navigate(["../model/"+t],{relativeTo:this.route})}handleAction({action:t,item:n}){const a={[m.EDIT]:this.handleModelEdit.bind(this)}[t.action];a&&a(n)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.gz),e.Y36(c.F0),e.Y36(d.$N))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-model-permissions"]],decls:1,vars:1,consts:[[3,"columnConfig","data","actions","action",4,"ngIf"],[3,"columnConfig","data","actions","action"]],template:function(t,n){1&t&&e.YNc(0,q,1,3,"ml-table",0),2&t&&e.Q6J("ngIf",n.dataSource.length)},dependencies:[f.O5,h.a]}),i})();const ee=[{path:"",component:Q,children:[{path:"permissions",component:(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["ml-permissions"]],decls:10,vars:0,consts:[["label","Users permissions"],[1,"my-3"],["label","Experiment permissions"],["label","Model permissions"]],template:function(t,n){1&t&&(e.TgZ(0,"mat-tab-group")(1,"mat-tab",0)(2,"div",1),e._UZ(3,"ml-user-permissions"),e.qZA()(),e.TgZ(4,"mat-tab",2)(5,"div",1),e._UZ(6,"ml-experiment-permissions"),e.qZA()(),e.TgZ(7,"mat-tab",3)(8,"div",1),e._UZ(9,"ml-model-permissions"),e.qZA()()())},dependencies:[D.SP,D.uX,K,j,$]}),i})()},{path:"user/:id",component:B},{path:"experiment/:id",component:N},{path:"model/:id",component:w},{path:"**",redirectTo:"permissions"}]}];let te=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.Bz.forChild(ee),c.Bz]}),i})();var ie=r(3912);let ne=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[f.ez,ie.m,te,v.u5,c.Bz]}),i})()}}]);