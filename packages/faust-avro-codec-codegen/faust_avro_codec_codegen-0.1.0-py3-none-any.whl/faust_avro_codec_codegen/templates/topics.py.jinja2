""" NOTICE!!
This file is generated by: {{ __name__ }}
Do not edit this file directly unless absolutely necessary!
"""
from schema_registry.client import SchemaRegistryClient
from schema_registry.client.schema import AvroSchema
from schema_registry.serializers.faust import FaustSerializer

from {{ models_module }} import {% for schema in schemas %}{{ schema.schema["name"] }}{% if not loop.last %}, {% endif %}{% endfor %}
from {{  faust_app_module }} import {{ faust_app_name }} as app
from {{ faust_settings_module }} import settings


client = SchemaRegistryClient(url=settings.SCHEMA_REGISTRY_URL)

{% for schema in schemas %}
{{ schema.name|replace("-", "_") }}_codec = FaustSerializer(
    client,
    "{{ schema.name }}-value",
    AvroSchema({{ schema.schema["name"] }}.avro_schema()),
)
{{ schema.name|replace("-", "_") }}_topic = app.topic("{{ schema.name }}", value_type={{ schema.schema["name"] }},
                                                      value_serializer={{ schema.name|replace("-", "_") }}_codec)
{% endfor %}
