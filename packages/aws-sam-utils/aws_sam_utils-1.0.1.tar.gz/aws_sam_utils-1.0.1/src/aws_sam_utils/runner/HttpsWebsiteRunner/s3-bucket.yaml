AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31

Resources:
    S3BucketLogs:
        Type: AWS::S3::Bucket # will NOT work on non-empty bucket
        DeletionPolicy: Delete
        Properties:
            AccessControl: LogDeliveryWrite
            BucketEncryption:
                ServerSideEncryptionConfiguration:
                    - ServerSideEncryptionByDefault:
                          SSEAlgorithm: AES256
            OwnershipControls:
                Rules:
                - ObjectOwnership: ObjectWriter
    S3BucketRoot:
        Type: AWS::S3::Bucket
        DeletionPolicy: Delete # will NOT work on non-empty bucket
        Properties:
            BucketEncryption:
                ServerSideEncryptionConfiguration:
                    - ServerSideEncryptionByDefault:
                          SSEAlgorithm: AES256
            OwnershipControls:
                Rules:
                - ObjectOwnership: ObjectWriter
            LoggingConfiguration:
                DestinationBucketName: !Ref 'S3BucketLogs'
                LogFilePrefix: 'origin/'


Outputs:
    S3BucketRoot:
        Description: Website bucket
        Value: !Ref S3BucketRoot
    S3BucketRootName:
        Description: Website bucket name
        Value: !GetAtt S3BucketRoot.DomainName
    S3BucketRootArn:
        Description: Website bucket locator
        Value: !GetAtt S3BucketRoot.Arn
    S3BucketLogs:
        Description: Logging bucket
        Value: !Ref S3BucketLogs
    S3BucketLogsName:
        Description: Logging bucket Name
        Value: !GetAtt S3BucketLogs.DomainName
