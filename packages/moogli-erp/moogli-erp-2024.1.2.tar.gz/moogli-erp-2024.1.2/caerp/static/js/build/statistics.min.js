(()=>{var e,t={8791:(e,t,n)=>{"use strict";var i=n(19755),o=n.n(i),l=n(13469),r=n.n(l),s=n(73864),a=n(72316),c=n.n(a),d=n(63574),h=n.n(d);const u=n(76258).Z.extend({appRoutes:{index:"index","":"index",addentry:"addEntry","editentry/:id":"editEntryMainData","entries/:id":"editEntry"}});var p=n(77070),m=n(69653),f=n.n(m),g=(n(57915),n(3819));const v=h().View.extend({tagName:"tr",template:g,regions:{},ui:{edit:"button.edit",delete:"button.delete",csv_export:"button.csv_export",duplicate:"button.duplicate"},triggers:{"click @ui.edit":"model:edit","click @ui.delete":"model:delete","click @ui.csv_export":"model:export","click @ui.duplicate":"model:duplicate"},childViewEvents:{},childViewTriggers:{},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")}});var w=n(28785);const y=h().View.extend({template:w}),b=h().CollectionView.extend({childView:v,emptyView:y,tagName:"tbody",childViewTriggers:{"model:edit":"model:edit","model:delete":"model:delete","model:export":"model:export","model:duplicate":"model:duplicate"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")}});var _=n(25781);const C=h().View.extend({template:_,regions:{list:{el:"tbody",replaceElement:!0}},childViewEvents:{"model:edit":"onModelEdit","model:delete":"onModelDelete","model:export":"onModelExport","model:duplicate":"onModelDuplicate"},childViewTriggers:{},initialize:function(){this.config=f().channel("config"),this.app=f().channel("app")},onRender:function(){this.showChildView("list",new b({collection:this.collection}))},onModelEdit:function(e){console.log("onModelEdit "+e.model.get("id")),this.app.trigger("navigate","/entries/"+e.model.get("id"))},onModelDelete:function(e){this.app.trigger("entry:delete",e)},onModelExport:function(e){this.app.trigger("entry:export",e.model)},onModelDuplicate:function(e){console.log("Duplicate"),this.app.trigger("entry:duplicate",e.model)}});var x,k=n(96510),V=n(15049),E=n(34543),S=n(35828);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function D(e,t,n){var i;return i=function(e,t){if("object"!=A(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=A(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==A(i)?i:String(i))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var O=n(36051);const q=h().View.extend((D(D(D(D(D(D(D(D(D(D(x={template:O,className:"main_content",behaviors:[E.Z]},"template",O),"regions",{entityField:".field-entity",keyField:".field-key"}),"ui",{form:"form",submit:"button[type=submit]",reset:"button[type=reset]"}),"events",{"submit @ui.form":"onSubmitForm","click @ui.reset":"onCancelClick","click @ui.submit":"onSubmitForm"}),"childViewEvents",{"finish:relationship":"onRelationshipFinish"}),"childViewTriggers",{}),"initialize",(function(e){this.statService=f().channel("stat"),this.facade=f().channel("facade"),this.mergeOptions(e,["attributePath","parentPath"]),console.log("Add Criterion form"),console.log("Attribute tree path"),console.log(this.attributePath),console.log(this.parentPath)})),"getFieldValue",(function(e){var t,n=(0,p.Nh)(this.getUI("form"));return e in n&&(t=n[e]),t})),"getPath",(function(e){e||(e=this.parentPath||this.getFieldValue("relationship"));var t,n=function(e){if(Array.isArray(e))return M(e)}(t=this.attributePath)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return e&&n.push(e),n})),"onSubmitForm",(function(e){e.preventDefault(),console.log("Submitting");var t=(0,p.Nh)(this.getUI("form")),n=t.key,i=this.getPath();console.log("   Path of the current model %s",i);var o=this.statService.request("find:column",n,i);this.model.set(t),console.log(this.model.attributes),this.model.set(o),console.log(this.model.attributes),this.facade.trigger("criterion:add",this.model),this.trigger("modal:close")})),D(D(D(D(x,"onCancelClick",(function(){console.log("Cancel clicked"),this.triggerMethod("reset:model"),this.triggerMethod("modal:close")})),"showKeySelect",(function(e){console.log("showKeySelect");var t=this.getPath(e),n=this.statService.request("get:attributes",t);console.log(n);var i=new S.Z({options:n,label:"Type de critère",id_key:"name",field_name:"key"});this.showChildView("keyField",i)})),"onRelationshipFinish",(function(e){console.log("onRelationshipFinish"),this.getPath(e),this.model.set("relationship",e),this.showKeySelect(e)})),"onRender",(function(){console.log(this.statService);var e=Object.values(this.statService.request("get:relationships",this.attributePath));console.log(e),e.splice(0,0,{label:"Entité",name:""});var t={options:e,label:"Type de critère",id_key:"name",field_name:"relationship"};this.parentPath&&(console.log(""),t.editable=!1,t.value=this.parentPath);var n=new S.Z(t);this.showChildView("entityField",n),this.showKeySelect()}))));var F=n(28291);const P=F.Z.extend({props:["id","key","method","type","entry_id","parent_id","relationship"]});var Z=n(12323);const j=h().View.extend({template:Z,regions:{},ui:{button:"input[type=radio]"},events:{"click @ui.button":"onClick"},modelEvents:{saved:"render"},childViewEvents:{"add:click":"onAddClick"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},onAddClick:function(){console.log("CombinationView.onAddClick"),this.trigger("add:click",this.model)},onClick:function(e){var t=e.target.value;this.model.set({type:t}),this.model.save({patch:!0,wait:!0})},templateContext:function(){return{is_and_clause:"and"==this.model.get("type"),is_or_clause:"or"==this.model.get("type")}}});var T=n(59903);const R=h().View.extend({tagName:"li",template:T,regions:{children:{el:".children",replaceElement:!0},combination:".combination"},childViewEvents:{"action:clicked":"onAddClick"},childViewTriggers:{"criterion:delete":"criterion:delete","add:click":"add:click"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},templateContext:function(){return{}},onAddClick:function(e){"add"==e&&(console.log("ClauseCriteriaView.onAddClick"),console.log(this.model),this.trigger("add:click",this.model))},showCombination:function(){if(this.model.collection.indexOf(this.model)>=1&&0==this.model.collection.path.length){var e=new j({model:this.model.collection._parent});this.showChildView("combination",e)}},onRender:function(){this.showCombination(),this.model.children.length>0&&this.showChildView("children",new this.__parentclass__({collection:this.model.children,parent:this}))}});var N=n(86552),z=n(27644),I=n(87519);const L=h().View.extend({template:I,tagName:"li",regions:{combination:".combination",selector:".form-group.selector",method:".form-group.method",search1:".form-group.search1",search2:".form-group.search2",deleteButton:{el:".delbutton-container",replaceElement:!0},addButton:".addbutton-container"},ui:{form:"form"},events:{"submit @ui.form":"onFormSubmit"},childViewEvents:{finish:"onFieldSelect","action:clicked":"onActionClicked"},childViewTriggers:{},modelEvents:{saved:"onModelSaved"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade"),this.service=f().channel("stat"),this.attributes=this.service.request("get:attributes",this.model)},templateContext:function(){return{label:this.service.request("find:label",this.model)}},onFormSubmit:function(e){e.preventDefault(),document.activeElement.blur()},onActionClicked:function(e){console.log("CommonCriteriaView.onActionClicked '%s'",e),"add"==e?this.triggerMethod("add:click",this.model):"delete"==e&&this.triggerMethod("criterion:delete",this.model)},onModelSaved:function(e){},showSelector:function(){var e=new S.Z({title:"Champ",options:this.attributes,id_key:"name",value:this.model.get("key"),field_name:"key"});this.showChildView("selector",e)},showMethod:function(){console.log("showMethod"),console.log(this.model);var e=this.service.request("find:methods",this.model.get("type")),t=!1;this.model.get("method")||(t=!0);var n=new S.Z({title:"Filtre",options:e,value:this.model.get("method"),field_name:"method",placeholder:t?"":void 0});this.showChildView("method",n)},_showStaticOptFields:function(){var e=this.service.request("find:static_options",this.model.get("key")),t=new S.Z({title:"Valeur",value:this.model.get("searches"),field_name:"searches",options:e,placeholder:"",multiple:!0});this.showChildView("search1",t)},_showManyToOneFields:function(){var e=this.service.request("find:manytoone_options",this.model.get("key")),t=new S.Z({title:"Valeur",value:this.model.get("searches"),field_name:"searches",options:e,placeholder:"",multiple:!0});this.showChildView("search1",t)},_showStringField:function(){var e=new z.Z({title:"Libellé",value:this.model.get("search1"),field_name:"search1"});this.showChildView("search1",e)},_showNumberField:function(){var e=this.model.get("method"),t="Valeur à comparer";["bw","nbw"].includes(e)&&(t="Entre");var n=new z.Z({title:"",ariaLabel:t,value:this.model.get("search1"),field_name:"search1"});if(this.showChildView("search1",n),["bw","nbw"].includes(e)){var i=new z.Z({title:"Et",value:this.model.get("search2"),field_name:"search2"});this.showChildView("search2",i)}},_showDateField:function(){var e=this.model.get("method");if(["dr","ndr"].includes(e)){var t=new N.Z({title:"Entre le",value:this.model.get("date_search1"),field_name:"date_search1"});this.showChildView("search1",t);var n=new N.Z({title:"Et le",value:this.model.get("date_search2"),field_name:"date_search2"});this.showChildView("search2",n)}},showSearches:function(){if(this.detachChildView("search1"),this.detachChildView("search2"),this.model.get("method")&&!["nll","nnll"].includes(this.model.get("method"))){var e=this.model.get("type");"static_opt"==e?this._showStaticOptFields():"manytoone"==e?this._showManyToOneFields():"string"==e?this._showStringField():"number"==e?this._showNumberField():"date"==e&&this._showDateField()}},onFieldSelect:function(e,t){var n=this;if(this.model.get(e)!=t){var i,o={};if(o[e]=t,"key"==e){var l=this.attributes[t];o.type=l.type,i=function(){n.showMethod(),n.showFields()}}else"method"==e&&(i=function(){n.showFields()});this.model.save(o,{wait:!0,patch:!0,success:i})}},showFields:function(){this.showSelector(),this.showMethod(),this.showSearches()},showButtons:function(){var e=new k.Z({label:"Supprimer",showLabel:!1,action:"delete",icon:"trash-alt"}),t=new V.Z({model:e,surroundingTagName:"div",surroundingCss:"actions"});if(this.showChildView("deleteButton",t),0==this.model.collection.path&&this.model.collection.length>1){var n=new k.Z({label:"Ajouter un critère à ce niveau de la hiérarchie",showLabel:!1,icon:"plus",action:"add"}),i=new V.Z({model:n,surroundingTagName:"div",surroundingCss:"actions"});this.showChildView("addButton",i)}else this.$el.find("ul").hide()},showCombination:function(){if(this.model.collection.indexOf(this.model)>=1&&0==this.model.collection.path.length){var e=new j({model:this.model.collection._parent});this.showChildView("combination",e)}},onRender:function(){this.showButtons(),this.showCombination(),this.showFields()}});var B=n(63501),U={string:L,date:L,multidate:L,number:L,static_opt:L,bool:L,manytoone:L,or:R,and:R,onetomany:h().View.extend({tagName:"li",template:B,regions:{children:{el:".children",replaceElement:!0},combination:".combination",deleteButton:{el:".delbutton-container",replaceElement:!0}},childViewEvents:{"add:click":"onAddClick","action:clicked":"onActionClicked"},childViewTriggers:{"criterion:delete":"criterion:delete"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade"),this.statService=f().channel("stat"),this.relationshipConfig=this.statService.request("find:column",this.model.get("key"),this.model.collection.path),console.log(this.relationshipConfig)},onAddClick:function(){console.log("ClauseCriteriaView.onAddClick"),console.log(this.model),this.trigger("add:click",this.model)},onActionClicked:function(e){console.log("OneToMany.onActionClicked"),"delete"==e?this.trigger("criterion:delete",this.model):"add"==e&&this.trigger("add:click",this.model)},templateContext:function(){return{label:this.relationshipConfig.label}},showButtons:function(){var e=new k.Z({label:"Supprimer",showLabel:!1,action:"delete",icon:"trash-alt"}),t=new V.Z({model:e,surroundingTagName:"div",surroundingCss:"actions"});this.showChildView("deleteButton",t)},onRender:function(){if(this.showButtons(),console.log(this.model),this.model.collection.indexOf(this.model)>=1&&0==this.model.collection.path.length){var e=new j({model:this.model.collection._parent});this.showChildView("combination",e)}this.model.children.length>0&&this.showChildView("children",new this.__parentclass__({collection:this.model.children,parent:this}))}})},$=h().View.extend({template:r().template("<div></div>")}),K=h().CollectionView.extend({tagName:"ul",emptyView:$,childViewTriggers:{"action:clicked":"action:clicked","add:click":"add:click","criterion:delete":"criterion:delete"},collectionEvents:{fetch:"render"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},childView:function(e){var t=U[e.get("type")];return t.prototype.__parentclass__=K,t},onRender:function(){var e=new k.Z({label:"Ajouter un critère à ce niveau de la hiérarchie",showLabel:!1,icon:"plus",event:"add:click"}),t=new V.Z({model:e,surroundingTagName:"li"});console.log("Add the add button to the collection view"),this.addChildView(t,this.children.length)}});const G=K;var J=n(27175);const H=h().View.extend({template:J,regions:{editButton:{el:".edit-btn-container",replaceElement:!0},criteria:".criteria-container",popup:".popup"},childViewEvents:{"edit:entry:click":"onEditClicked","add:click":"onAddClicked","criterion:delete":"onCriterionDelete"},initialize:function(e){this.config=f().channel("config"),this.facade=f().channel("facade"),this.listenTo(this.facade,"criterion:added",this.renderList.bind(this)),console.log(e),this.mergeOptions(e,["criteriaCollection"]),console.log(this.criteriaCollection)},onButtonClicked:function(e){"editentry"==e?this.onEditClicked():this.onAddClicked(this.getRootCriterion())},onEditClicked:function(){f().channel("app").trigger("navigate","editentry/"+this.model.get("id"))},getRootCriterion:function(){return this.criteriaCollection.models[0]},onAddClicked:function(e){console.log("EntryFormComponent"),e=e||this.getRootCriterion();var t,n=new P({parent_id:e.get("id"),entry_id:this.model.get("id")});"onetomany"===e.get("type")&&(t=e.get("key"));var i=new q({model:n,attributePath:e.collection.path,parentPath:t});this.showChildView("popup",i)},onCriterionDelete:function(e){var t=this;window.confirm("Êtes-vous sûr de vouloir supprimer cet élément ?")&&e.destroy({wait:!0,success:function(){return t.criteriaCollection.fetch({reset:!0,success:function(){return t.render()}})}})},renderList:function(){this.showChildView("criteria",new G({collection:this.getRootCriterion().children}))},renderAddButton:function(){var e=new k.Z({label:"Nouveau critère",css:"btn icon",icon:"plus",event:"add:click"}),t=new V.Z({model:e});this.showChildView("criteria",t)},onRender:function(){this.showChildView("editButton",new V.Z({model:new k.Z({label:"edit",showLabel:!1,css:"btn icon only unstyled",icon:"pen",event:"edit:entry:click"})})),this.getRootCriterion().children.length>0?this.renderList():this.renderAddButton()}});var Q=n(96944),W=n(5391),X=n(65082),Y=n(4861);const ee=h().View.extend({template:Y,className:"main_content",behaviors:[W.Z],regions:{title:".field-title",description:".field-description"},initialize:function(){this.config=f().channel("config")},onSuccessSync:function(){f().channel("app").trigger("navigate","entries/"+this.model.get("id"))},onCancelForm:function(){var e=f().channel("app");this.getOption("add")?e.trigger("navigate","index"):e.trigger("navigate","entries/"+this.model.get("id"))},templateContext:function(){return{title:this.getOption("add")?"Ajouter une entrée statistique":"Modifier une entrée statistique"}},onRender:function(){console.log(this.model),this.showChildView("title",new z.Z({field_name:"title",label:"Intitulé de l'entrée statistique",description:"Intitulé de l'entrée statistique tel qu'il figurera dans l'export",required:!0,value:this.model.get("title")})),this.showChildView("description",new X.Z({field_name:"description",label:"Description de l'entrée statistique",description:"Description de l'entrée statistique tel qu'elle figurera dans l'export",value:this.model.get("description"),required:!1}))}});var te=n(61828),ne=h().View.extend({template:r().template('<div class="alert alert-error"><%- message %></div>'),templateContext:function(){return{message:this.getOption("message")}}});const ie=h().View.extend({behaviors:[E.Z],template:te,regions:{message:".message-container",sheets:".field-sheets"},ui:{form:"form",submit:"button[type=submit]",cancel:"button[type=reset]"},events:{"click @ui.submit":"onSubmit","submit @ui.form":"onSubmit","click @ui.cancel":"onCancelForm"},childViewEvents:{},childViewTriggers:{},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},onSubmit:function(e){var t=this;e.preventDefault();var n=this.getChildView("sheets").getCurrentValue();n?this.facade.request("entry:duplicate",this.model,n).then((function(){return t.onSuccessSync()})):this.showChildView("message",new ne({message:"Veuillez choisir une feuille statistiques"}))},onSuccessSync:function(){this.triggerMethod("modal:close")},onCancelForm:function(){this.triggerMethod("modal:close")},templateContext:function(){return{title:"Dupliquer l'entrée statistique "+this.model.get("title")}},onRender:function(){this.showChildView("sheets",new S.Z({label:"Vers la feuille de statistiques",options:this.getOption("sheets"),field_name:"sheet",required:!0,id_key:"id",label_key:"title",placeholder:""}))}}),oe=h().View.extend({template:n(44874),regions:{toolbar:"#toolbar",main:"#main",popup:".entry-popup"},initialize:function(){this.facade=f().channel("facade"),this.config=f().channel("config"),this.app=f().channel("app")},_showSheetToolbar:function(){var e=this.config.request("get:form_actions");e.main=[{option:{url:"#addentry",label:"Ajouter une entrée",icon:"plus",title:"Ajouter une entrée statistiques",css:"btn btn-primary icon"},widget:"anchor"}];var t=new Q.Z(e);this.showChildView("toolbar",t)},_triggerEntryDelete:function(e){console.log("Trigger entry delete"),this.app.trigger("entry:delete",this.getChildView("main"))},_showEntryToolbar:function(e){var t=this,n={main:[{option:{label:"Revenir à la liste",icon:"arrow-left",title:"Revenir à la liste des entrées",url:"#index",css:"btn icon"},widget:"anchor"}],more:[{option:{icon:"copy",title:"Dupliquer cette entrée statistiques",onclick:function(n){return t.app.trigger("entry:duplicate",e)},css:"btn icon only"},widget:"button"},{option:{icon:"file-csv",title:"Exporter les données de gestion sociale associée à cette entrée",onclick:function(n){return t.app.trigger("entry:export",e)},css:"btn icon only"},widget:"button"},{option:{icon:"trash-alt",title:"Supprimer cette entrée statistiques",onclick:function(e){return t._triggerEntryDelete(e)},css:"btn icon only"},widget:"button"}]};console.log("Show entry toolbar"),console.log(n);var i=new Q.Z(n);this.showChildView("toolbar",i)},showEntryDuplicateForm:function(e){var t=this.config.request("get:options","sheet_list"),n=new ie({model:e,sheets:t});this.showChildView("popup",n)},_showEntryAdd:function(e,t){var n=new ee({model:e,destCollection:t,add:!0});this.showChildView("main",n)},_showEntryEditMainData:function(e,t){var n=new ee({model:e,destCollection:t,add:!1});this.showChildView("main",n)},_showEntryEdit:function(e,t){var n=new H({model:e,criteriaCollection:t});this.showChildView("main",n)},_showEntryList:function(){var e=this.facade.request("get:collection","entries"),t=new C({collection:e});this.showChildView("main",t)},entryAdd:function(e,t){this._showEntryAdd(e,t)},entryEdit:function(e,t){this._showEntryToolbar(e),this._showEntryEdit(e,t)},entryEditMainData:function(e,t){this._showEntryEditMainData(e,t)},index:function(){console.log("Index view"),this._showSheetToolbar(),this._showEntryList()}}),le=F.Z.extend({props:["id","title","description","sheet_id","criteria"],defaults:{criteria:[]},validation:{title:{required:!0,msg:"est requis"}},exportUrl:function(){return"/statistics/entries/"+this.get("id")+".csv"},criteria_url:function(){return this.url()+"/criteria"},duplicateUrl:function(){return this.url()+"?action=duplicate"}}),re=h().Object.extend({initialize:function(e){this.facade=f().channel("facade"),this.config=f().channel("config"),this.app=f().channel("app"),console.log("Controller.initialize"),this.rootView=e.rootView,this.productDefaults=this.config.request("get:options","defaults")},index:function(){console.log("Controller.index"),this.rootView.index()},showModal:function(e){this.rootView.showModal(e)},editEntry:function(e){var t=this,n=this.facade.request("get:entry",e);(0,p.VO)(),this.facade.request("load:criteria",n).then((function(e){(0,p.Gx)(),t.rootView.entryEdit(n,e)}))},addEntry:function(){var e=this.facade.request("get:collection","entries"),t=new le;this.rootView.entryAdd(t,e)},editEntryMainData:function(e){var t=this.facade.request("get:collection","entries"),n=t.get(e);this.rootView.entryEditMainData(n,t)},showEntryExport:function(e){var t=e.exportUrl();window.openPopup(t)},showEntryDuplicate:function(e){this.rootView.showEntryDuplicateForm(e)},_onModelDeleteSuccess:function(){f().channel("message").trigger("success",this,"Vos données ont bien été supprimées"),this.app.trigger("navigate","index")},_onModelDeleteError:function(){f().channel("message").trigger("error",this,"Une erreur a été rencontrée lors de la suppression de cet élément")},modelDelete:function(e){console.log("Controller.modelDelete"),window.confirm("Êtes-vous sûr de vouloir supprimer cet élément ?")&&e.model.destroy({success:this._onModelDeleteSuccess.bind(this),error:this._onModelDeleteError.bind(this),wait:!0})}});var se=n(13469);const ae=new(h().Application.extend({channelName:"app",radioEvents:{navigate:"onNavigate","show:modal":"onShowModal","entry:delete":"onDelete","entry:export":"onEntryExport","entry:duplicate":"onEntryDuplicate","criterion:delete":"onDelete"},region:"#js-main-area",onBeforeStart:function(e,t){console.log(" - AppClass : Initializing UI components"),this.rootView=new oe,this.controller=new re({rootView:this.rootView}),this.router=new u({controller:this.controller})},onStart:function(e,t){this.showView(this.rootView),console.log(" - AppClass : Starting the js history"),(0,p.Gx)(),c().history.start()},onEntryExport:function(e){this.controller.showEntryExport(e)},onEntryDuplicate:function(e){this.controller.showEntryDuplicate(e)},onNavigate:function(e,t){console.log(" - AppClass.onNavigate : %s",e);var n=e;se.isUndefined(t)||(n+="/"+t),window.location.hash=n,c().history.loadUrl(n)},onShowModal:function(e){this.controller.showModal(e)},onDelete:function(e){this.controller.modelDelete(e)}}));var ce=n(74773),de=n(19755);function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const ue=new(h().Object.extend({channelName:"stat",radioRequests:{"find:column":"findModelColumn","find:methods":"findMethods","get:attributes":"_getAttributes","get:relationships":"_getRelationships","find:static_options":"findStaticOptions","find:manytoone_options":"findManyToOneOptions"},_getColumnLevel:function(e){var t=[];if(console.log("Looking for column level informations"),console.log(e),Array.isArray(e))t=e;else{var n=e;n&&n.collection&&n.collection.path&&(t=n.collection.path)}var i=this.columns;t?Array.isArray(t)||(t=[t]):t=[];var o,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){s=!0,l=e},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw l}}}}(t);try{for(l.s();!(o=l.n()).done;)parent=o.value,i=i.relationships[parent]}catch(e){l.e(e)}finally{l.f()}return i},_clone:function(e){return JSON.parse(JSON.stringify(e))},_getAttributes:function(e){var t=this._getColumnLevel(e);return this._clone(t.attributes)},_getRelationships:function(e){var t=this._getColumnLevel(e);return this._clone(t.relationships)},findModelColumn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];console.log("Find the model for a given column %s %s",e,t);var n,i=this._getColumnLevel(t);return e in i.attributes?n=i.attributes[e]:i.relationships&&e in i.relationships?n=i.relationships[e]:console.error("Erreur, il y a des anciennes options statistiques qui ne sont plus supportées %s",e),console.log(n),this._clone(n)},findMethods:function(e){return this._clone(this.form_config.options.methods[e])},findStaticOptions:function(e){return this._clone(this.form_config.options.static_opt_options[e])},findManyToOneOptions:function(e){return this._clone(this.form_config.options.manytoone_options[e])},setFormConfig:function(e){this.form_config=e,this.columns=e.options.columns},setup:function(e){},start:function(){this.setFormConfig(ce.Z.form_config);var e=de.Deferred();return e.resolve(ce.Z.form_config,null,null),e}})),pe=c().Model.extend({validation:{title:{required:!0,msg:"est requis"}},exportUrl:function(){return this.url()+".csv"}});var me=n(44910);const fe=c().Collection.extend({model:le});var ge=P.extend({props:["searches","search1","search2","date_search1","date_search2"]});ge.prototype.props=ge.prototype.props.concat(P.prototype.props);const ve=ge;var we=P.extend({props:["children"],initialize:function(){this.populate()},populate:function(){if(this.has("children")){var e=this.collection.path.concat([]);this.has("key")&&e.push(this.get("key")),this.children=new this.collection.__class__(this.get("children"),{path:e,url:this.collection.url})}this.children._parent=this,this.children.url=this.collection.url}});we.prototype.props=we.prototype.props.concat(P.prototype.props);const ye=we;var be=ye.extend({}),_e={manytoone:ve,static_opt:ve,or:ye,and:ye,onetomany:be,bool:ve,string:ve,date:ve,multidate:ve,number:ve},Ce=c().Collection.extend({initialize:function(e,t){t=t||{},this.path="path"in t?t.path:[],"url"in t&&(this.url=t.url)},model:function(e,t){var n=e.type;return!n in _e&&console.error("Unknown model typ %s",n),new _e[n](e,t)}});Ce.prototype.__class__=Ce;const xe=Ce;var ke=n(19755);const Ve=new(h().Object.extend(me.Z).extend({radioEvents:{"criterion:add":"onAddCriterion"},radioRequests:{"get:model":"getModelRequest","get:collection":"getCollectionRequest","get:entry":"getEntry","load:collection":"loadCollection","is:valid":"isDatasValid","load:criteria":"loadCriteriaCollection","entry:duplicate":"onEntryDuplicate"},initialize:function(e){var t;this.models={},this.models.sheet=new pe({}),this.collections={},t=new fe,this.collections.entries=t},setup:function(e){this.setModelUrl("sheet",e.context_url),this.setCollectionUrl("entries",e.entries_url)},getEntry:function(e){return console.log(" - Facade : Retrieving entry "+e),this.collections.entries.get(e)},loadCriteriaCollection:function(e){return console.log(" - Facade : Retrieving the criteria defining the entry "+e.get("id")),(this.collections.criteria=new xe).url=e.criteria_url(),this.loadCollection("criteria")},onAddCriterion:function(e){var t=this;e.url=this.collections.criteria.url;var n=f().channel("facade");e.save({wait:!0,sort:!0}).then((function(e){return t.collections.criteria.fetch({reset:!0,success:function(e){return n.trigger("criterion:added")}})}))},onEntryDuplicate:function(e,t){var n=this,i=parseInt(e.get("sheet_id"))==parseInt(t),o=(0,p.xc)(e.duplicateUrl(),{sheet_id:t},"POST");return i&&(o=o.then((function(e){return n.collections.entries.fetch()}))),o},start:function(){var e=this.loadModel("sheet"),t=this.loadCollection("entries");return ke.when(e,t)}}));o()((function(){console.log(" # Page Loaded : starting the js code #"),(0,s.oo)(AppOption,ae,Ve,{customServices:[ue]})}))},36051:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="work_form" class="size_middle">\n    <form>\n    <div role="dialog" id="work-forms" aria-modal="true" aria-labelledby="work-forms_title">\n        <div class=\'modal_layout\'>\n            <header>\n                <button class="icon only unstyled close" title="Fermer cette fenêtre" aria-label="Fermer cette fenêtre"  type=\'button\'>\n                    <svg><use href="/static/icons/endi.svg#times"></use></svg>\n                </button>\n                <h2>Ajouter un critère</h2>\n            </header>\n            <div class="modal_content_layout">\n                <input type=\'hidden\' name=\'parent_id\' value=\''+e.escapeExpression("function"==typeof(l=null!=(l=r(n,"parent_id")||(null!=t?r(t,"parent_id"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"parent_id",hash:{},data:o,loc:{start:{line:12,column:61},end:{line:12,column:74}}}):l)+"' />\n                <div class='modal_content'>\n                    <div class='message-container'></div>\n                    <div class='errors'></div>\n                    <fieldset>\n                        <div class='field-entity'></div>\n                        <div class='field-key'></div>\n                    </fieldset>\n                </div>\n                <footer>\n                    <button\n                        class='btn btn-primary'\n                        type='submit'\n                        value='submit'>\n                        Valider\n                    </button>\n                    <button\n                        class='btn'\n                        type='reset'\n                        value='submit'\n                        title=\"Annuler et fermer cette fenêtre\">\n                        Annuler\n                    </button>\n                </footer>\n            </div>\n        </div>\n    </div>\n    </form>\n</section>\n"},useData:!0})},59903:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return"<div class='combination'>\n</div>\n<div class='children'>\n</div>"},useData:!0})},12323:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({1:function(e,t,n,i,o){return'                checked="checked" \n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=null!=t?t:e.nullContext||{},s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<fieldset class="icon_choice" title="Combinaison des critères">\n    <div class="layout flex">\n        <h6 class="screen-reader-text">\n            Combinaison des critères\n        </h6>\n        <label>\n            <input \n                type="radio"\n'+(null!=(l=s(n,"if").call(r,null!=t?s(t,"is_and_clause"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:9,column:16},end:{line:11,column:23}}}))?l:"")+'                value=\'and\'\n                class="visuallyhidden">\n            <span>\n                et\n            </span>\n        </label>\n        <label>\n            <input \n                type="radio" \n'+(null!=(l=s(n,"if").call(r,null!=t?s(t,"is_or_clause"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:21,column:16},end:{line:23,column:23}}}))?l:"")+"                value='or'\n                class=\"visuallyhidden\">\n            <span>\n                ou\n            </span>\n        </label>\n    </div>\n</fieldset>"},useData:!0})},87519:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return"<form>\n    <fieldset>\n        <div class='combination'>\n        </div>\n        <div class='layout flex'>\n        <div class='form-group selector'></div>\n            <div class='form-group method'></div>\n            <div class='form-group search1'></div>\n            <div class='form-group search2'></div>\n        </div>\n    </fieldset>\n    <div class='delbutton-container'></div>\n    <ul><li class='add_line addbutton-container'></li></ul>\n</form>"},useData:!0})},27175:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,a="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div class='tree_view with_actions first_level'>\n   <h1>\n       "+c(typeof(l=null!=(l=d(n,"title")||(null!=t?d(t,"title"):t))?l:s)===a?l.call(r,{name:"title",hash:{},data:o,loc:{start:{line:3,column:7},end:{line:3,column:16}}}):l)+"\n        <span class='edit-btn-container'></span>\n   </h1>\n   <p>"+c(typeof(l=null!=(l=d(n,"description")||(null!=t?d(t,"description"):t))?l:s)===a?l.call(r,{name:"description",hash:{},data:o,loc:{start:{line:6,column:6},end:{line:6,column:21}}}):l)+"</p>\n    <form>\n        <h2 class='title'>Choix des critères</h2>\n        <div class='search_filters content vertical_padding criteria-container'>\n        </div>\n    </form>\n</div>  \n<div class='popup'></div>"},useData:!0})},63501:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<fieldset>\n    <div class='combination'></div>\n    <div class='layout flex'>\n    <div class='form-group'>\n        <label>Type de critère</label>\n        <select disabled>\n            <option>"+e.escapeExpression("function"==typeof(l=null!=(l=r(n,"label")||(null!=t?r(t,"label"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"label",hash:{},data:o,loc:{start:{line:7,column:20},end:{line:7,column:29}}}):l)+"</option>\n        </select>\n    </div>\n    </div>\n\n</fieldset>\n    <div class='delbutton-container'></div>\n\n<div class='children'>\n</div>"},useData:!0})},4861:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<form name=\"current\">\n\t<div class='limited_width width40'>\n\t\t<div class='message-container'></div>\n\t\t<div class='errors'></div>\n\t\t<fieldset>\n\t\t\t<h2 class=\"title\">"+e.escapeExpression("function"==typeof(l=null!=(l=r(n,"title")||(null!=t?r(t,"title"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:6,column:21},end:{line:6,column:32}}}):l)+"</h2>\n\t\t\t<div class='field-title'></div>\n\t\t\t<div class='field-description'></div>\n\t\t</fieldset>\n\n        <div class=\"layout flex main_actions\">\n            <div role='group'>\n                <button class='btn btn-primary icon' type='submit' value='submit'>\n                    <svg><use href=\"/static/icons/endi.svg#save\"></use></svg>Enregistrer\n                </button>\n                <button class='icon' type='reset' value='submit' title=\"Annuler et revenir en arrière\" aria-label=\"Annuler et revenir en arrière\">\n                    <svg><use href=\"/static/icons/endi.svg#times\"></use></svg>Annuler\n                </button>\n            </div>\n            <div class='resume'></div>\n        </div>\n    </div>\n</form>"},useData:!0})},61828:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="work_form" class="size_middle">\n    <form name="current">\n        <div role="dialog" id="work-forms" aria-modal="true" aria-labelledby="work-forms_title">\n            <div class=\'modal_layout\'>\n                <header>\n                    <button class="icon only unstyled close" title="Fermer cette fenêtre"\n                        aria-label="Fermer cette fenêtre" type=\'button\'>\n                        <svg>\n                            <use href="/static/icons/endi.svg#times"></use>\n                        </svg>\n                    </button>\n                    <h2>'+e.escapeExpression("function"==typeof(l=null!=(l=r(n,"title")||(null!=t?r(t,"title"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:12,column:24},end:{line:12,column:33}}}):l)+"</h2>\n                </header>\n                <div class=\"modal_content_layout\">\n                    <div class='modal_content'>\n                        <div class='message-container'></div>\n                        <div class='errors'></div>\n                        <fieldset>\n                            <div class='field-sheets'></div>\n                        </fieldset>\n                    </div>\n                    <footer>\n                        <button class='btn btn-primary icon' type='submit' value='submit'>\n                            <svg>\n                                <use href=\"/static/icons/endi.svg#save\"></use>\n                            </svg>Dupliquer\n                        </button>\n                        <button class='icon' type='reset' value='submit' title=\"Annuler et revenir en arrière\"\n                            aria-label=\"Annuler et revenir en arrière\">\n                            <svg>\n                                <use href=\"/static/icons/endi.svg#times\"></use>\n                            </svg>Annuler\n                        </button>\n                    </footer>\n                </div>\n            </div>\n        </div>\n    </form>\n</section>\n"},useData:!0})},28785:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return"<div>Aucune entrée statistiques n'a été saisie</div>"},useData:!0})},25781:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return'<h3>Entrées statistiques</h3>\n<div class="table_container">\n    <table class=\'top_align_table hover_table\'>\n        <thead>\n            <tr>\n                <th scope="col" class="col_text"><span class="screen-reader-text">Intitulé</span></th>\n                <th scope="col" class="col_actions" title="Actions"><span class="screen-reader-text">Actions</span></th>\n            </tr>\n        </thead>\n        <tbody></tbody>\n    </table>\n</div>'},useData:!0})},3819:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){var l,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<td class='col_text'>"+e.escapeExpression("function"==typeof(l=null!=(l=r(n,"title")||(null!=t?r(t,"title"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:1,column:21},end:{line:1,column:30}}}):l)+"</td>\n<td class='col_actions width_four'>\n    <button class='btn icon only edit'>\n        <svg><use href=\"/static/icons/endi.svg#pen\"></use></svg>\n    </button>\n    <button class='btn icon only duplicate'>\n        <svg><use href=\"/static/icons/endi.svg#copy\"></use></svg>\n    </button>\n    <button class='btn icon only csv_export'>\n        <svg><use href=\"/static/icons/endi.svg#file-csv\"></use></svg>\n    </button>\n    <button class='btn icon only negative delete'>\n        <svg><use href=\"/static/icons/endi.svg#trash-alt\"></use></svg>\n    </button>\n\n</td>"},useData:!0})},44874:(e,t,n)=>{var i=n(40202);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,i,o){return"<div class=\"main_toolbar\" id=\"toolbar\"></div>\n<div class=\"content_vertical_padding\" id='main'>\n    <div id='entries' class='content_vertical_padding'></div>\n</div>\n<div class='entry-popup'></div>"},useData:!0})}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var l=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(l.exports,l,l.exports,i),l.loaded=!0,l.exports}i.m=t,e=[],i.O=(t,n,o,l)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,o,l]=e[d],s=!0,a=0;a<n.length;a++)(!1&l||r>=l)&&Object.keys(i.O).every((e=>i.O[e](n[a])))?n.splice(a--,1):(s=!1,l<r&&(r=l));if(s){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,o,l]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i.j=193,(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&!e;)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={193:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var o,l,[r,s,a]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in s)i.o(s,o)&&(i.m[o]=s[o]);if(a)var d=a(i)}for(t&&t(n);c<r.length;c++)l=r[c],i.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return i.O(d)},n=self.webpackChunkenDI=self.webpackChunkenDI||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=i.O(void 0,[736],(()=>i(8791)));o=i.O(o)})();