(()=>{"use strict";var __webpack_modules__={353:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(196),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),js_spread_grid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(649);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function _iterableToArrayLimit(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i,l,s=[],a=!0,c=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;a=!1}else for(;!(a=(n=i.call(o)).done)&&(s.push(n.value),s.length!==t);a=!0);}catch(e){c=!0,r=e}finally{try{if(!a&&null!=o.return&&(l=o.return(),Object(l)!==l))return}finally{if(c)throw r}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach((function(t){_defineProperty(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function _defineProperty(e,t,o){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function isString(e){return"string"==typeof e||e instanceof String}function useResolvedFormatting(formatting){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){var context="{data, rows, columns, row, column, value, newValue, text, string}";return formatting.map((function(rule){var mappedRule={};if("column"in rule&&(mappedRule.column=rule.column),"row"in rule&&(mappedRule.row=rule.row),"condition"in rule&&(mappedRule.condition=eval("(".concat(context,") => (").concat(rule.condition,")"))),"value"in rule&&(mappedRule.value=eval("(".concat(context,")=> (").concat(rule.value,")"))),"text"in rule&&(mappedRule.text=eval("(".concat(context,") => (").concat(rule.text,")"))),"style"in rule&&(mappedRule.style=isString(rule.style)?eval("(".concat(context,") => (").concat(rule.style,")")):rule.style),"padding"in rule&&(mappedRule.padding=isString(rule.padding)?eval("(".concat(context,") => (").concat(rule.padding,")")):rule.padding),"edit"in rule)if(rule.edit){var mappedEdit={};"validate"in rule.edit&&(mappedEdit.validate=eval("({string}) => (".concat(rule.edit.validate,")"))),"parse"in rule.edit&&(mappedEdit.parse=eval("(".concat(context,") => (").concat(rule.edit.parse,")"))),"auto_commit"in rule.edit&&(mappedEdit.autoCommit=rule.edit.auto_commit),mappedRule.edit=mappedEdit}else mappedRule.edit=rule.edit;return mappedRule}))}),[formatting])}function useResolvedFiltering(filtering){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){var context="{data, rows, columns, row, column, value, text, expression}";return filtering.map((function(rule){var mappedRule={};return"column"in rule&&(mappedRule.column=rule.column),"row"in rule&&(mappedRule.row=rule.row),"condition"in rule&&(mappedRule.condition=eval("(".concat(context,") => (").concat(rule.condition,")"))),mappedRule}))}),[filtering])}function DashSpreadGrid(e){console.count("render DashSpreadGrid");var t=e.setProps,o=e.data,n=e.columns,r=e.rows,i=useResolvedFormatting(e.formatting),l=useResolvedFiltering(e.filtering),s=e.pinned_top,a=e.pinned_bottom,c=e.pinned_left,u=e.pinned_right,d=e.filters,p=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(e){t({filters:e})}),[t]),h=e.clicked_cell,f=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(e){t({clicked_cell:_objectSpread({},e)})}),[t]),m=e.clicked_custom_cell,_=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(e){t({clicked_custom_cell:_objectSpread({},e)})}),[t]),g=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),y=g[0],w=g[1];return y&&(0,js_spread_grid__WEBPACK_IMPORTED_MODULE_2__.Z)(y,{data:o,columns:n,rows:r,formatting:i,filtering:l,pinnedTop:s,pinnedBottom:a,pinnedLeft:c,pinnedRight:u,filters:d,onFiltersChange:p,clickedCell:h,onCellClick:f,clickedCustomCell:m,onCustomCellClick:_}),react__WEBPACK_IMPORTED_MODULE_0___default().createElement("div",{ref:w})}DashSpreadGrid.propTypes={setProps:prop_types__WEBPACK_IMPORTED_MODULE_1___default().func,id:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,data:prop_types__WEBPACK_IMPORTED_MODULE_1___default().any,columns:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,rows:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,formatting:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,filtering:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,sorting:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,dataSelector:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string,pinned_top:prop_types__WEBPACK_IMPORTED_MODULE_1___default().number,pinned_bottom:prop_types__WEBPACK_IMPORTED_MODULE_1___default().number,pinned_left:prop_types__WEBPACK_IMPORTED_MODULE_1___default().number,pinned_right:prop_types__WEBPACK_IMPORTED_MODULE_1___default().number,borderWidth:prop_types__WEBPACK_IMPORTED_MODULE_1___default().number,focusedCell:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,selectedCells:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,highlightedCells:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,editedCells:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,filters:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,sortBy:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,columnWidths:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,rowHeights:prop_types__WEBPACK_IMPORTED_MODULE_1___default().array,clicked_cell:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object,clicked_custom_cell:prop_types__WEBPACK_IMPORTED_MODULE_1___default().object},DashSpreadGrid.defaultProps={data:[],columns:[{type:"DATA-BLOCK"}],rows:[{type:"HEADER"},{type:"DATA-BLOCK"}],formatting:[],filtering:[],sorting:[],dataSelector:"data[row.id][column.id]",pinned_top:0,pinned_bottom:0,pinned_left:0,pinned_right:0,borderWidth:1,focusedCell:null,selectedCells:[],highlightedCells:[],editedCells:[],filters:[],sortBy:[],columnWidths:[],rowHeights:[],clicked_cell:null,clicked_custom_cell:null};const __WEBPACK_DEFAULT_EXPORT__=DashSpreadGrid},64:e=>{e.exports=window.PropTypes},196:e=>{e.exports=window.React},649:(e,t,o)=>{function n(e){return null===e?"null":Array.isArray(e)?`[${e.map(n).join(",")}]`:"object"==typeof e?(t=e,`{${Object.keys(t).sort().map((e=>`${e}:${n(t[e])}`)).join(",")}}`):JSON.stringify(e);var t}function r(e,t){return"FILTER"===e.type^"FILTER"===t.type?"FILTER":"DATA"===e.type&&"DATA"===t.type?"DATA":"OTHER"}function i(e,t,o,i){return e.map((e=>{const l=n(e.columnId),s=n(e.rowId);if(!o.has(l))return null;if(!i.has(s))return null;const a=o.get(l),c=i.get(s);return{edit:t.resolve(c,a).edit,cell:e,type:r(a,c)}})).filter((e=>e?.edit))}o.d(t,{Z:()=>Se});const l="12px Calibri",s={top:2,right:5,bottom:2,left:5};function a(e,t){return Math.round(e*t)/t}function c(e,t,o){const n=e.state,r=e.canvases[`${t}-${o}`],i=n.sections[t],s=n.sections[o],c=s.columns,u=i.rows;if(0===u.length||0===c.length)return void(r.parentElement&&r.parentElement.removeChild(r));r.parentElement||e.element.appendChild(r),console.log("draw");const d=r.getContext("2d",{alpha:!1}),p=n.scrollRect,h=n.textResolver,f=n.renderFormatResolver,m=n.borderWidth,_=i.showTopBorder,g=i.showBottomBorder,y=s.showLeftBorder,w=s.showRightBorder,b=m/2,E=u.length-1+(_?1:0)+(g?1:0),x=c.length-1+(y?1:0)+(w?1:0),v=u.map((e=>e.height)),R=c.map((e=>e.width)),A=R.reduce(((e,t)=>e+t),0)+x*m,C=v.reduce(((e,t)=>e+t),0)+E*m,k="center"===o?p.left:0,I="middle"===t?p.top:0,D="center"===o?p.width:s.width,M="middle"===t?p.height:i.height,T=R.reduce(((e,t,o)=>{const n=e[o]+t+m;return e.push(n),e}),[y?m:0]),O=v.reduce(((e,t,o)=>{const n=e[o]+t+m;return e.push(n),e}),[_?m:0]),L=T.slice(0,-1),P=O.slice(0,-1),B=Math.max(L.findLastIndex((e=>e<=k)),0),S=L.findLastIndex((e=>e<=k+D)),K=Math.max(P.findLastIndex((e=>e<=I)),0),W=P.findLastIndex((e=>e<=I+M)),F=Math.max(B,y?0:1),N=S+(w?1:0),z=Math.max(K,_?0:1),U=W+(g?1:0),j=Array.from({length:W-K+1},((e,t)=>{const o=u[t+K];return Array.from({length:S-B+1},((e,t)=>{const n=c[t+B];return f.resolve(o,n)}))})),H=(e,t)=>j[e-K][t-B];r.width=Math.round(D*devicePixelRatio),r.height=Math.round(M*devicePixelRatio),r.style.width=`${D}px`,r.style.height=`${M}px`,r.style.marginLeft=`${k}px`,r.style.marginTop=`${I}px`,r.style.marginRight=A-D-k+"px",r.style.marginBottom=C-M-I+"px",d.fillStyle="#E9E9E9",d.fillRect(0,0,r.width,r.height);const q=(e,t)=>{d.setTransform(devicePixelRatio,0,0,devicePixelRatio,(e-k)*devicePixelRatio,(t-I)*devicePixelRatio)},$=(e,t,o,n)=>{d.beginPath(),d.rect(e,t,o,n),d.clip()};for(let e=B;e<=S;e++){d.save(),q(T[e],0),$(0,0,R[e],C);for(let t=K;t<=W;t++){const o=H(t,e),n=o.style,r=O[t],i=T[e],s=R[e],c=v[t],u=o.text,p=n.textAlign||"left",f=n.textBaseline||"middle",_=o.padding;q(i,r),d.fillStyle=n.background||"white",d.fillRect(0,0,s,c),"draw"in o&&o.draw(d),n.highlight&&(d.fillStyle=n.highlight,d.fillRect(0,0,s,c)),n.corner&&(d.fillStyle=n.corner,d.beginPath(),d.moveTo(s-7,c),d.lineTo(s,c),d.lineTo(s,c-7),d.fill()),d.fillStyle=n.foreground||"black",d.font=n.font||l,d.textAlign=p;const g=h.getFontMetrics(n.font),y=a("left"===p?_.left:"center"===p?s/2:"right"===p?s-_.right:0,devicePixelRatio),w=a("top"===f?g.middle+g.topOffset+_.top:"middle"===f?c/2+g.middle:"bottom"===f?c+g.middle-g.bottomOffset-_.bottom:0,devicePixelRatio);w-g.middle-g.topOffset>=0&&w-g.middle+g.bottomOffset<=c?d.fillText(u,y,w):(d.strokeStyle="#E9E9E9",d.lineWidth=m,d.beginPath(),d.moveTo(0,m+b),d.lineTo(s,m+b),d.moveTo(0,c-m-b),d.lineTo(s,c-m-b),d.stroke(),d.save(),$(0,2*m,s,c-4*m),d.fillText(u,y,w),d.restore())}d.restore()}q(0,0);const V=(e,t,o,n,r)=>{if(!r)return;const i=r.width*m,l=t===n,s=e-(l?i/2:0),a=t-(l?0:i/2),c=o+(l?i/2:0),u=n+(l?0:i/2);d.strokeStyle=r.color||"black",d.lineWidth=i,r.dash?(d.setLineDash(r.dash.map((e=>e/devicePixelRatio))),d.lineDashOffset=l?s:a):d.setLineDash([]),d.beginPath(),d.moveTo(s,a),d.lineTo(c,u),d.stroke()},G=(e,t)=>e?t?e.index>t.index?e:t:e:t;for(let e=z;e<=U;e++){const t=e-1,o=e;for(let e=B;e<=S;e++){const n=G(t>=K?H(t,e).style.borderBottom:null,o<=W?H(o,e).style.borderTop:null);V(T[e]-b,O[o]-b,T[e+1]-b,O[o]-b,n)}}for(let e=F;e<=N;e++){const t=e-1,o=e;for(let e=K;e<=W;e++){const n=G(t>=B?H(e,t).style.borderRight:null,o<=S?H(e,o).style.borderLeft:null);V(T[o]-b,O[e]-b,T[o]-b,O[e+1]-b,n)}}}function u(e){if(!e.error)try{!function(e){c(e,"top","left"),c(e,"top","center"),c(e,"top","right"),c(e,"middle","left"),c(e,"middle","center"),c(e,"middle","right"),c(e,"bottom","left"),c(e,"bottom","center"),c(e,"bottom","right"),function(e){const t=e.element,o=e.input,n=e.state,r=n.inputPlacement;if(!r){if(o.parentElement){const e=document.activeElement===o;o.parentElement.removeChild(o),e&&t.focus({preventScroll:!0})}return}const i=e.canvases[r.section];if(o.style.left="left"in r?`${r.left}px`:"0",o.style.top="top"in r?`${r.top}px`:"0",o.style.right="right"in r?`${r.right}px`:"0",o.style.bottom="bottom"in r?`${r.bottom}px`:"0",o.style.marginLeft="marginLeft"in r?`${r.marginLeft}px`:"0",o.style.marginTop="marginTop"in r?`${r.marginTop}px`:"0",o.style.width=`${r.width}px`,o.style.height=`${r.height}px`,o.style.gridArea=i.style.gridArea,o.style.zIndex=i.style.zIndex,o.style.backgroundColor=n.isTextValid?"white":"#eb3434",!o.parentElement){const e=document.activeElement===t;t.appendChild(o),e&&o.focus({preventScroll:!0})}}(e),function(e){const t=e.element,o=e.state;o.resizableColumn&&o.resizableRow?t.style.cursor="nwse-resize":o.resizableColumn?t.style.cursor="col-resize":o.resizableRow?t.style.cursor="row-resize":t.style.cursor="default"}(e)}(e)}catch(t){e.error=t}e.error&&function(e){const t=e.element,o=e.error;t.style.backgroundColor="#9f0000",t.style.color="white",t.style.padding="20px",t.style.display="flex",t.style.flexDirection="column",t.innerHTML=`\n        <div style="font-size: 16px;">\n            An error occurred while rendering the grid, please contact the support.\n        </div>\n        <div style="font-size: 20px; font-weight: bold; padding: 20px 0;">\n            ${o.message}\n        </div>\n        <div style="font-size: 16px; white-space: pre-wrap;">${o.stack}</div>\n    `}(e)}function d(e,t,o){return[{column:{match:"DATA"},row:{match:"HEADER"},value:({column:e})=>void 0===e.header?e.id:e.header},{column:{match:"HEADER"},row:{match:"DATA"},value:({row:e})=>void 0===e.header?e.id:e.header},{column:{match:"HEADER"},row:{match:"SPECIAL"},value:""},{column:{match:"SPECIAL"},row:{match:"HEADER"},value:""},...o.map((({columnId:e,rowId:t,direction:n},r)=>({column:{id:e},row:{id:t},text:({column:e})=>`${o.length>1?r+1:""}${"ASC"===n?"⇣":"⇡"} ${e.header}`}))),{column:{match:"ANY"},row:{match:"FILTER"},value:({newValue:e})=>e||"",text:({newValue:e})=>e||"Search...",edit:{validate:()=>!0,parse:({string:e})=>e,autoCommit:!0}},{column:{match:"DATA"},row:{match:"DATA"},value:t},...e]}function p(e){return e}function h(e,t){return t?e+"99":e+"33"}function f(e,t,o,r,i,l,s,a){const c=o?n(o.columnId):null,u=o?n(o.rowId):null,d=null!==s,p=null!==a,f=d||p,m=(e,t,o,n)=>{if(o<0||o>=e.length)return!1;if(n<0||n>=t.length)return!1;const i=e[o].key,l=t[n].key;return r.isKeySelected(i,l)},_=(e,t)=>e?[t]:[];return[{column:{match:"ANY"},row:{match:"FILTER"},style:({newValue:e})=>({background:"#FBFBFB",foreground:e?"black":"#cccccc",border:{width:1,color:"gray"}})},{column:{match:"ANY"},row:{match:"HEADER"},style:{background:"#F5F5F5",border:{width:1,color:"gray"}}},{column:{match:"HEADER"},row:{match:"ANY"},style:{background:"#F5F5F5",border:{width:1,color:"gray"}}},{column:{match:"HEADER"},row:{match:"HEADER"},style:{background:"#E0E0E0"}},...e,..._(t&&!d,{column:{id:t?.columnId},row:{match:"ANY"},style:{highlight:"#81948133"}}),..._(t&&!p,{column:{match:"ANY"},row:{id:t?.rowId},style:{highlight:"#81948133"}}),..._(t&&!f,{column:{id:t?.columnId},row:{id:t?.rowId},style:{highlight:"#81948188"}}),{column:{match:"ANY"},row:{match:"ANY"},condition:({rows:e,columns:t,row:o,column:n})=>m(e,t,o.index,n.index),style:({rows:e,columns:t,row:o,column:n,edit:r})=>({...m(e,t,o.index-1,n.index)?{}:{borderTop:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},...m(e,t,o.index+1,n.index)?{}:{borderBottom:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},...m(e,t,o.index,n.index-1)?{}:{borderLeft:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},...m(e,t,o.index,n.index+1)?{}:{borderRight:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},highlight:h(r?"#798d9c":"#819481",c!==n.key||u!==o.key)})},{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>i.isKeySelected(e.key,t.key),style:({row:e,column:t})=>({highlight:h("#93a8b8",c!==t.key||u!==e.key)})},..._(o,{column:{id:o?.columnId},row:{id:o?.rowId},style:{highlight:"#ffffffaa"}}),{column:{match:"ANY"},row:{match:"ANY"},condition:({edit:e})=>e,style:{corner:"#77777720"}},{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>l.hasValueByKey(e.key,t.key),style:{corner:"darkgreen"}},..._(s,{column:{id:s},row:{match:"HEADER"},style:{borderRight:{width:5,color:"cornflowerblue"}}}),..._(a,{column:{match:"HEADER"},row:{id:a},style:{borderBottom:{width:5,color:"cornflowerblue"}}})]}function m(e,t){const o=t.filter((e=>"BEGIN"===e.pinned)).length,n=t.filter((e=>"END"===e.pinned)).length,r=t.length-o-n,i=e.filter((e=>"BEGIN"===e.pinned)).length,l=e.filter((e=>"END"===e.pinned)).length,s=e.length-i-l,a=t.slice(0,o),c=t.slice(t.length-n,t.length),u=t.slice(o,t.length-n),d=e.slice(0,i),p=e.slice(e.length-l,e.length),h=e.slice(i,e.length-l),f=o>0,m=i>0,_=r>0||!f,g=!f,y=!(n>0),w=s>0||!m,b=!m,E=!(l>0),x=(e,t,o)=>{if(0===e.length)return 0;const n=t?e.at(0).topWithBorder:e.at(0).top;return(o?e.at(-1).bottomWithBorder:e.at(-1).bottom)-n},v=(e,t,o)=>{if(0===e.length)return 0;const n=t?e.at(0).leftWithBorder:e.at(0).left;return(o?e.at(-1).rightWithBorder:e.at(-1).right)-n};return{top:{rows:a,showTopBorder:!0,showBottomBorder:!0,height:x(a,!0,!0)},bottom:{rows:c,showTopBorder:_,showBottomBorder:!0,height:x(c,_,!0)},middle:{rows:u,showTopBorder:g,showBottomBorder:y,height:x(u,g,y)},left:{columns:d,showLeftBorder:!0,showRightBorder:!0,width:v(d,!0,!0)},right:{columns:p,showLeftBorder:w,showRightBorder:!0,width:v(p,w,!0)},center:{columns:h,showLeftBorder:b,showRightBorder:E,width:v(h,b,E)}}}function _(e,t){return[...e,...t.map((e=>({columnId:e.columnId,rowId:e.rowId,value:e.expression})))]}class g{constructor(e){this.lookup=new Map,e.forEach((e=>{const t=n(e.rowId),o=n(e.columnId);this.lookup.has(t)||this.lookup.set(t,new Map),this.lookup.get(t).set(o,e.value)}))}hasValueByKey(e,t){return this.lookup.has(e)&&this.lookup.get(e).has(t)}getValueByKey(e,t){if(this.hasValueByKey(e,t))return this.lookup.get(e).get(t)}hasValueById(e,t){return this.hasValueByKey(n(e),n(t))}getValueById(e,t){return this.getValueByKey(n(e),n(t))}}function y(e){return new g(e)}class w{constructor(e){this.lookup=new Map,e.forEach((e=>{const t=n(e.rowId),o=n(e.columnId);this.lookup.has(t)||this.lookup.set(t,new Set),this.lookup.get(t).add(o)}))}isKeySelected(e,t){return this.lookup.has(e)&&this.lookup.get(e).has(t)}isIdSelected(e,t){return this.isKeySelected(n(e),n(t))}}function b(e){return new w(e)}function E(e,t){return"function"==typeof e?e(t):e}function x(e,t,o,n){return e<o?"BEGIN":e>=t-n?"END":void 0}function v(e,t,o){return e.map(((r,i)=>{const l="id"in r?r.id:r.type;return{...r,id:l,type:r.type||"DATA",index:i,key:n(l),pinned:x(i,e.length,t,o),header:"header"in r?r.header:l,labels:r.labels||[]}}))}function R(e,t,o,r){const i=new Map(r.map((({columnId:e,width:t})=>[n(e),t])));return v(e,t,o).map((e=>({...e,width:i.has(e.key)?i.get(e.key):e.width})))}function A(e,t,o,r){const i=new Map(r.map((({rowId:e,height:t})=>[n(e),t])));return v(e,t,o).map((e=>({...e,height:i.has(e.key)?i.get(e.key):e.height})))}function C(e,t,o){let n=o;return e.map(((e,r)=>{const i=a("width"in e?e.width:100,t),l={...e,index:r,width:i,leftWithBorder:n-o,left:n,right:n+i,rightWithBorder:n+i+o};return n+=l.width+o,l}))}function k(e,t,o){let n=o;return e.map(((e,r)=>{const i=a("height"in e?e.height:20,t),l={...e,index:r,height:i,topWithBorder:n-o,top:n,bottom:n+i,bottomWithBorder:n+i+o};return n+=l.height+o,l}))}const I={HEADER:["HEADER"],FILTER:["FILTER"],DATA:["DATA"],CUSTOM:["CUSTOM"],ANY:["HEADER","DATA","FILTER","CUSTOM"],SPECIAL:["HEADER","FILTER","CUSTOM"],undefined:[]};class D{byKey=new Map;byIndex=new Map;byLabel=new Map;byMatch=new Map}class M{lookup=new D;hasRules=!1;addRule(e,t,o){if(this.hasRules=!0,Array.isArray(e))for(const n of e)this.addRule(n,t,o);else if(Array.isArray(t))for(const n of t)this.addRule(e,n,o);else{e=e?"id"in e?{key:n(e.id)}:e:{match:"DATA"},t=t?"id"in t?{key:n(t.id)}:t:{match:"DATA"},"key"in e&&i(this.lookup.byKey,e.key),"index"in e&&i(this.lookup.byIndex,e.index),"label"in e&&i(this.lookup.byLabel,e.label);for(const t of I[e.match])i(this.lookup.byMatch,t)}function r(e,t){e.has(t)||e.set(t,[]),e.get(t).push(o)}function i(e,o){e.has(o)||e.set(o,new D),"key"in t&&r(e.get(o).byKey,t.key),"index"in t&&r(e.get(o).byIndex,t.index),"label"in t&&r(e.get(o).byLabel,t.label);for(const n of I[t.match])r(e.get(o).byMatch,n)}}getRules(e,t){const o=[];if(!this.hasRules)return o;function n(e){for(const t of e)o.push(t)}function r(e){e.byKey.has(t.key)&&n(e.byKey.get(t.key)),e.byIndex.has(t.index)&&n(e.byIndex.get(t.index)),e.byMatch.has(t.type)&&n(e.byMatch.get(t.type));for(const o of t.labels)e.byLabel.has(o)&&n(e.byLabel.get(o))}this.lookup.byKey.has(e.key)&&r(this.lookup.byKey.get(e.key)),this.lookup.byIndex.has(e.index)&&r(this.lookup.byIndex.get(e.index)),this.lookup.byMatch.has(e.type)&&r(this.lookup.byMatch.get(e.type));for(const t of e.labels)this.lookup.byLabel.has(t)&&r(this.lookup.byLabel.get(t));return o}}const T=["borderTop","borderRight","borderBottom","borderLeft"];function O(e,t){const o={...e};if("border"in o){for(const e of T)o[e]=o.border;delete o.border}for(const e of T)e in o&&(o[e]={...o[e],index:t});return o}class L{constructor(e){this.rulesLookup=new M;for(const[t,o]of e.entries()){const e={index:t};"condition"in o&&(e.condition=o.condition),"style"in o&&(e.style="function"==typeof o.style?o.style:()=>o.style),"value"in o&&(e.value="function"==typeof o.value?o.value:()=>o.value),"text"in o&&(e.text="function"==typeof o.text?o.text:()=>o.text),"padding"in o&&(e.padding="function"==typeof o.padding?o.padding:()=>o.padding),"edit"in o&&(e.edit=o.edit),"draw"in o&&(e.draw=o.draw),this.rulesLookup.addRule(o.column,o.row,e)}}resolve(e,t,o,n,r,i){const l=this.rulesLookup.getRules(r,n).sort(((e,t)=>e.index-t.index)).filter(((e,t,o)=>e.index!==o[t-1]?.index));let a,c={data:e,rows:t,columns:o,row:n,column:r},u={},d=s;i.hasValueByKey(n.key,r.key)&&(c={...c,newValue:i.getValueByKey(n.key,r.key)});for(const e of l)if((!("condition"in e)||e.condition(c))&&("value"in e&&(c={...c,value:e.value(c)}),"style"in e&&(u={...u,...O(e.style(c),e.index)}),"text"in e&&(c={...c,text:e.text(c)}),"padding"in e&&(d={...d,...e.padding(c)}),"edit"in e&&(c={...c,edit:e.edit&&"edit"in c?{...c.edit,...e.edit}:e.edit}),"draw"in e)){const t=c;a=o=>e.draw({...t,ctx:o})}const p={style:u,visible:!0,text:"text"in c?c.text:`${c.value}`,padding:d};return"value"in c&&(p.value=c.value),"edit"in c&&(p.edit=c.edit),void 0!==a&&(p.draw=a),"text"in c&&(p.text=c.text),p}}function P(e){return new L(e)}class B{constructor(e,t,o,n,r){this.formattingRules=e,this.data=t,this.rows=o,this.columns=n,this.edition=r}resolve(e,t){return this.formattingRules.resolve(this.data,this.rows,this.columns,e,t,this.edition)}}function S(e,t,o,n,r){return new B(e,t,o,n,r)}function K(e,t,o){const r=new Map;for(const i of e){const e=n(i[t]),l=n(i[o]);r.has(e)||r.set(e,new Map),r.get(e).set(l,i.expression)}return r}function W(e,t,o,n,r,i,l){if(0===e.length)return r;const s=K(e,"columnId","rowId"),a=i.filter((e=>"FILTER"!==e.type&&s.has(e.key)));return 0===a.length?r:r.filter((e=>{for(const c of a){const a=o.resolve(n,r,i,e,c,l),u=s.get(c.key);if(!t.resolve(n,r,i,e,c,a.value,a.text,u))return!1}return!0}))}function F(e,t,o,n,r,i,l){if(0===e.length)return i;const s=K(e,"rowId","columnId"),a=r.filter((e=>"FILTER"!==e.type&&s.has(e.key)));return 0===a.length?i:i.filter((e=>{for(const c of a){const a=o.resolve(n,r,i,c,e,l),u=s.get(c.key);if(!t.resolve(n,r,i,c,e,a.value,a.text,u))return!1}return!0}))}function N(e,t,o,n){return{top:e,bottom:t,left:o,right:n}}function z(e,t){return{width:e.length?e.at(-1).rightWithBorder:0,height:t.length?t.at(-1).bottomWithBorder:0}}class U{constructor(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.fontMetrics=new Map}measureWidth(e,t){const o=this.context;return o.font=t||l,o.measureText(e).width}measureHeight(e,t){let o=1;for(const t of e)"\n"===t&&o++;return o*this.getFontMetrics(t).height}getFontMetrics(e){const t=e;if(this.fontMetrics.has(t))return this.fontMetrics.get(t);const o=this.context;o.font=e||l;const n=o.measureText("X"),r=(n.actualBoundingBoxDescent-n.actualBoundingBoxAscent)/2,i={topOffset:r+n.fontBoundingBoxAscent,middle:-r,bottomOffset:n.fontBoundingBoxDescent-r,height:n.fontBoundingBoxAscent+n.fontBoundingBoxDescent};return this.fontMetrics.set(t,i),i}}function j(){return new U}function H(e,t){return t.top>=e.top&&t.left>=e.left&&t.top+t.height<=e.top+e.height&&t.left+t.width<=e.left+e.width}function q(e,t){const o={top:Math.max(e.top,t.top),left:Math.max(e.left,t.left),width:Math.min(e.left+e.width,t.left+t.width)-Math.max(e.left,t.left),height:Math.min(e.top+e.height,t.top+t.height)-Math.max(e.top,t.top)};return o.width>=0&&o.height>=0?o:{top:e.top,left:e.left,width:0,height:0}}function $(e,t){return{top:e.top-t,left:e.left-t,width:e.width+2*t,height:e.height+2*t}}function V(e){return e.width*e.height}function G(e,t){return{top:e.top,left:e.left,width:Math.max(0,e.width-t.left-t.right),height:Math.max(0,e.height-t.top-t.bottom)}}const Y=200,X=400,Z={left:0,top:0,width:0,height:0};function J(e){return e.reduce(((e,t)=>e.set(t.key,t)),new Map)}function Q(e,t,o,r,i,l,s,a){if(!e)return[];if(t)return[];if(!r)return[];if(!o)return[];const c=n(o.columnId),u=n(o.rowId),d=n(r.columnId),p=n(r.rowId);if(!s.has(c))return[];if(!a.has(u))return[];if(!s.has(d))return[];if(!a.has(p))return[];const h=Math.min(s.get(c).index,s.get(d).index),f=Math.max(s.get(c).index,s.get(d).index),m=Math.min(a.get(u).index,a.get(p).index),_=Math.max(a.get(u).index,a.get(p).index);return i.slice(h,f+1).flatMap((e=>l.slice(m,_+1).map((t=>({rowId:t.id,columnId:e.id})))))}function ee(e,t){const o=function(e){return"BEGIN"===e.pinned?"top":"END"===e.pinned?"bottom":"middle"}(t),n=function(e){return"BEGIN"===e.pinned?"left":"END"===e.pinned?"right":"center"}(e);return`${o}-${n}`}function te(e,t,o,r,i){if(!t)return null;const l=n(t.columnId),s=n(t.rowId);if(!o.has(l))return null;if(!r.has(s))return null;const a=o.get(l),c=r.get(s);if(0===e.length)return null;const u={width:a.width,height:c.height,section:ee(a,c)};switch(c.pinned){case"BEGIN":u.top=c.top;break;case"END":u.bottom=i.top.height+i.middle.height+i.bottom.height-c.top-c.height;break;default:u.marginTop=c.top-i.top.height}switch(a.pinned){case"BEGIN":u.left=a.left;break;case"END":u.right=i.left.width+i.center.width+i.right.width-a.left-a.width;break;default:u.marginLeft=a.left-i.left.width}return u}function oe(e,t){return t.every((t=>t.edit.validate({string:e})))}function ne(e){return Array.isArray(e)?e.map(((e,t)=>t)):Object.keys(e)}function re(e){return ne(e)}function ie(e){if(Array.isArray(e))return e.length>0?Object.keys(e[0]):[];{const t=Object.keys(e);return t.length>0?ne(e[t[0]]):[]}}function le(e,t){if(!e.some((e=>"DATA-BLOCK"===e.type)))return e;const o=[];for(const n of e)if("DATA-BLOCK"===n.type){const e="selector"in n?n.selector(t):ie(t);for(const t of e)o.push({...n,id:t,type:"DATA"})}else o.push(n);return o}function se(e,t){if(!e.some((e=>"DATA-BLOCK"===e.type)))return e;const o=[];for(const n of e)if("DATA-BLOCK"===n.type){const e="selector"in n?n.selector(t):re(t);for(const t of e)o.push({...n,id:t,type:"DATA"})}else o.push(n);return o}const ae=({text:e,expression:t})=>e.includes(t);class ce{constructor(e){this.rulesLookup=new M;for(const t of e){const e={by:n("by"in t?t.by:"FILTER"),condition:t.condition||ae};this.rulesLookup.addRule(t.column,t.row,e)}}resolve(e,t,o,n,r,i,l,s){const a=this.rulesLookup.getRules(r,n);if(0===a.length)return"DATA"!==n.type||"DATA"!==r.type||!s.has('"FILTER"')||ae({text:l,expression:s.get('"FILTER"')});let c={data:e,rows:t,columns:o,row:n,column:r,value:i,text:l};for(const e of a){if(!s.has(e.by))continue;const t={...c,expression:s.get(e.by)};if(!e.condition(t))return!1}return!0}}function ue(e){return new ce(e)}function de(e){return e}function pe(e){return e}function he(e,t,o,n,r,i){if(e.every((e=>"number"==typeof e.width)))return e;const l=e=>{const i="width"in e?e.width:"fit-once";if("number"==typeof i)return i;if(r.has(e.key)){const t=r.get(e.key);if("fit-once"===i&&!t.dataOnly)return t.width;if("fit-data-once"===i&&t.dataOnly)return t.width}let l=0;for(const r of t){if("DATA"!==r.type&&"fit-data-once"===i)continue;if("DATA"!==r.type&&"fit-data"===i)continue;const t=n.resolve(r,e),s=t.text,a=t.font,c=t.padding.left+t.padding.right,u=o.measureWidth(s,a)+c;l=Math.max(l,u)}return r.set(e.key,{width:l,dataOnly:"fit-data-once"===i}),l};for(const e of r.keys())i.has(e)||r.delete(e);return e.map((e=>({...e,width:l(e)})))}function fe(e,t,o,n,r,i){if(t.every((e=>"number"==typeof e.height)))return t;const l=t=>{const i="height"in t?t.height:"fit-once";if("number"==typeof i)return i;if(r.has(t.key)){const e=r.get(t.key);if("fit-once"===i&&!e.dataOnly)return e.height;if("fit-data-once"===i&&e.dataOnly)return e.height}let l=0;for(const r of e){if("DATA"!==r.type&&"fit-data-once"===i)continue;if("DATA"!==r.type&&"fit-data"===i)continue;const e=n.resolve(t,r),s=e.text,a=e.font,c=e.padding.top+e.padding.bottom,u=o.measureHeight(s,a)+c;l=Math.max(l,u)}return r.set(t.key,{height:l,dataOnly:"fit-data-once"===i}),l};for(const e of r.keys())i.has(e)||r.delete(e);return t.map((e=>({...e,height:l(e)})))}function me(e){return new Set(e.map((e=>e.key)))}function _e(e){return e}const ge=(e,t)=>e.value<t.value,ye=(e,t)=>e.value>t.value;class we{constructor(e){this.rulesLookup=new M;for(const t of e){const e={by:stringifyId("by"in t?t.by:"HEADER"),comparatorAsc:t.comparator||ge,comparatorDesc:(e,o)=>-t.comparator(e,o)||ye};this.rulesLookup.addRule(t.column,t.row,e)}}resolve(e,t,o){const n=this.rulesLookup.getRules(e,t);if(0===n.length)return"DATA"!==t.type||"DATA"!==e.type?null:o.has('"HEADER"')?"ASC"===o.get('"HEADER"')?ge:ye:null;if(n.length>1)throw new Error("Multiple sorting rules for the same cell");const r=n[0];return"ASC"===o.get(r.by)?r.comparatorAsc:r.comparatorDesc}}function be(e){return new we(e)}function Ee(e,t,o){const r=new Map;for(const i of e){const e=n(i[t]),l=n(i[o]);r.has(e)||r.set(e,new Map),r.get(e).set(l,i.direction)}return r}function xe(e,t){e.sort(((e,t)=>{const o=e.comparator(e.cell,t.cell);return"number"==typeof o?o:o?-1:1})),t.push(...e.map((e=>e.entity))),e.length=0}function ve(e,t,o,r,i,l,s){if(0===e.length)return i;const a=Ee(e,"columnId","rowId"),c=new Map(l.map((e=>[e.key,e]))),u=e.map((e=>n(e.columnId))).filter((e=>c.has(e))).map((e=>c.get(e))).reverse();if(0===u.length)return i;for(const e of u){const n=[],c=[];for(const u of i){const d=t.resolve(e,u,a.get(e.key));if(!d){xe(c,n),n.push(u);continue}const p={entity:u,comparator:d,cell:o.resolve(r,i,l,u,e,s)};0!==c.length&&c[0].comparator!==d?(xe(c,n),c.push(p)):c.push(p)}xe(c,n),i=n}return i}function Re(e,t,o,r,i,l,s){if(0===e.length)return l;const a=Ee(e,"rowId","columnId"),c=new Map(i.map((e=>[e.key,e]))),u=e.map((e=>n(e.rowId))).filter((e=>c.has(e))).map((e=>c.get(e))).reverse();if(0===u.length)return l;for(const e of u){const n=[],c=[];for(const u of l){const d=t.resolve(u,e,a.get(e.key));if(!d){xe(c,n),n.push(u);continue}const p={entity:u,comparator:d,cell:o.resolve(r,i,l,e,u,s)};0!==c.length&&c[0].comparator!==d?(xe(c,n),c.push(p)):c.push(p)}xe(c,n),l=n}return l}const Ae=5;function Ce(e,t,o,r,i){if(!r)return null;const l=t.get(n(r.columnId)),s=o.get(n(r.rowId)),a=i.x;return"HEADER"!==s.type?null:a>=l.right-Ae&&a<=l.right+Ae?l.id:0===l.index||a<l.left-Ae||a>l.left+Ae?null:e[l.index-1].id}function ke(e,t,o,r,i){if(!r)return null;const l=t.get(n(r.columnId)),s=o.get(n(r.rowId)),a=i.y;return"HEADER"!==l.type?null:a>=s.bottom-Ae&&a<=s.bottom+Ae?s.id:0===s.index||a<s.top-Ae||a>s.top+Ae?null:e[s.index-1].id}function Ie(e){return e.map((e=>({columnId:"columnId"in e?e.columnId:"HEADER",rowId:"rowId"in e?e.rowId:"HEADER",direction:e.direction})))}function De(e){return e.map((e=>({columnId:"columnId"in e?e.columnId:"FILTER",rowId:"rowId"in e?e.rowId:"FILTER",expression:e.expression})))}function Me(e){console.count("updateState");const t={...e.localOptions,...e.externalOptions},o=e.memory,n=e.state;function r(e,t,n){const r=o[e]&&o[e].dependencies;return r&&!n.some(((e,t)=>e!==r[t]))||(o[e]={value:t(...n),dependencies:n}),o[e].value}const l=window.devicePixelRatio,s=t.borderWidth/l,a=t.data,c=e.input.value,u=r("sortBy",Ie,[t.sortBy]),h=r("filters",De,[t.filters]),g=r("textResolver",j,[]),w=r("dataFormatting",d,[t.formatting,t.dataSelector,u]),x=r("editedCellsAndFilters",_,[t.editedCells,h]),v=r("edition",y,[x]),I=r("invokedColumns",E,[t.columns,a]),D=r("invokedRows",E,[t.rows,a]),M=r("unfoldedColumns",le,[I,a]),T=r("unfoldedRows",se,[D,a]),O=r("unfilteredColumns",R,[M,t.pinnedLeft,t.pinnedRight,t.columnWidths]),L=r("unfilteredRows",A,[T,t.pinnedTop,t.pinnedBottom,t.rowHeights]),B=r("unfilteredColumnKeys",me,[O]),K=r("unfilteredRowKeys",me,[L]),U=r("filterFormatting",de,[w]),ee=r("filterFormattingRules",P,[U]),ne=r("filteringRules",ue,[t.filtering]),re=r("filteredColumns",F,[h,ne,ee,a,L,O,v]),ie=r("filteredRows",W,[h,ne,ee,a,L,O,v]),ae=r("sortingFormatting",_e,[w]),ce=r("sortingFormattingRules",P,[ae]),ge=r("sortingRules",be,[t.sorting]),ye=r("sortedColumns",Re,[u,ge,ce,a,ie,re,v]),we=r("sortedRows",ve,[u,ge,ce,a,ie,re,v]),Ee=r("measureFormatting",pe,[w]),xe=r("measureFormattingRules",P,[Ee]),Ae=r("measureFormatResolver",S,[xe,a,we,ye,v]),Me=e.columnWidthCache,Te=e.rowHeightCache,Oe=r("measuredColumns",he,[ye,we,g,Ae,Me,B]),Le=r("measuredRows",fe,[ye,we,g,Ae,Te,K]),Pe=r("columns",C,[Oe,l,s]),Be=r("rows",k,[Le,l,s]),Se=r("columnLookup",J,[Pe]),Ke=r("rowLookup",J,[Be]),We=t.focusedCell,Fe=r("sections",m,[Pe,Be]),Ne=t.selectedCells,ze=r("fixedSize",N,[Fe.top.height,Fe.bottom.height,Fe.left.width,Fe.right.width]),Ue=r("totalSize",z,[Pe,Be]),je=function(e,t,o,n,r,i){if(!t)return null;if(t.x<0||t.y<0||t.x>i.width||t.y>i.height)return null;const l=e.scrollLeft,s=e.scrollTop,a=e.clientWidth,c=e.clientHeight,u=t.x<=r.left?t.x:t.x>=a-r.right?i.width-a+t.x:t.x+l,d=function(e,t){if(0===e.length)return-1;if(t<e[0].topWithBorder)return-1;if(t>e[e.length-1].bottomWithBorder)return-1;let o=0,n=e.length-1;for(;o<=n;){const r=Math.floor((o+n)/2);if(t<e[r].topWithBorder)n=r-1;else{if(!(t>e[r].bottomWithBorder))return r;o=r+1}}return-1}(o,t.y<=r.top?t.y:t.y>=c-r.bottom?i.height-c+t.y:t.y+s),p=function(e,t){if(0===e.length)return-1;if(t<e[0].leftWithBorder)return-1;if(t>e[e.length-1].rightWithBorder)return-1;let o=0,n=e.length-1;for(;o<=n;){const r=Math.floor((o+n)/2);if(t<e[r].leftWithBorder)n=r-1;else{if(!(t>e[r].rightWithBorder))return r;o=r+1}}return-1}(n,u);return-1===d||-1===p?null:{rowId:o[d].id,columnId:n[p].id}}(e.element,e.mousePosition,Be,Pe,ze,Ue),He=e.resizingColumn||r("resizableColumn",Ce,[Pe,Se,Ke,je,e.mousePosition]),qe=e.resizingRow||r("resizableRow",ke,[Be,Se,Ke,je,e.mousePosition]),$e=r("highlightedCells",Q,[e.isMouseDown,!!He||!!qe,We,je,Pe,Be,Se,Ke]),Ve=r("selection",b,[Ne]),Ge=r("highlight",b,[$e]),Ye=r("renderFormatting",f,[w,je,We,Ve,Ge,v,He,qe]),Xe=r("renderFormattingRules",P,[Ye]),Ze=r("renderFormatResolver",S,[Xe,a,Be,Pe,v]),Je=r("inputFormatting",p,[w]),Qe=r("inputFormattingRules",P,[Je]),et=r("inputFormatResolver",S,[Qe,a,Be,Pe,v]),tt=r("editableCells",i,[Ne,et,Se,Ke]),ot=r("inputPlacement",te,[tt,We,Se,Ke,Fe]),nt=r("isTextValid",oe,[c,tt]),rt=function(e,t,o,n){const r={width:n.getBoundingClientRect().width,height:n.getBoundingClientRect().height},i={left:n.scrollLeft,top:n.scrollTop},l=e||Z,s=G({left:0,top:0,...t},o),a=G({...i,...r},o),c=q(s,$(a,Y)),u=q(s,$(a,X));return H(s,l)&&H(l,c)?V(l)>2*V(u)?u:l:u}(n?.scrollRect,Ue,ze,e.element);e.state={options:t,devicePixelRatio:l,borderWidth:s,data:a,dataFormatting:w,edition:v,filteredColumns:re,filteredRows:ie,columns:Pe,rows:Be,sections:Fe,selectedCells:Ne,selection:Ve,highlight:Ge,hoveredCell:je,focusedCell:We,renderFormatting:Ye,renderFormatResolver:Ze,inputFormatting:Je,inputFormatResolver:et,fixedSize:ze,totalSize:Ue,textResolver:g,scrollRect:rt,highlightedCells:$e,inputPlacement:ot,columnLookup:Se,rowLookup:Ke,text:c,isTextValid:nt,resizableColumn:He,resizableRow:qe}}function Te(e){if(!e.error)try{Me(e)}catch(t){e.error=t}}function Oe(e,t){const o=new w(t);return[...t,...e.filter((e=>!o.isIdSelected(e.rowId,e.columnId)))]}function Le(e,t){const o=new w(t);return e.filter((e=>!o.isIdSelected(e.rowId,e.columnId)))}function Pe(e){const t=e.currentTarget.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function Be(e){if("spread-grid-context"in e)return;console.log("initialize");const t={"top-left":document.createElement("canvas"),"top-center":document.createElement("canvas"),"top-right":document.createElement("canvas"),"middle-left":document.createElement("canvas"),"middle-center":document.createElement("canvas"),"middle-right":document.createElement("canvas"),"bottom-left":document.createElement("canvas"),"bottom-center":document.createElement("canvas"),"bottom-right":document.createElement("canvas")},o=document.createElement("input");e.setAttribute("tabindex","0"),e.setAttribute("style","max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none; user-select: none;"),e.classList.add("spread-grid"),t["top-left"].setAttribute("style","position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;"),t["top-center"].setAttribute("style","position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;"),t["top-right"].setAttribute("style","position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;"),t["middle-left"].setAttribute("style","position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;"),t["middle-center"].setAttribute("style","grid-row: 2; grid-column: 2; z-index: 0;"),t["middle-right"].setAttribute("style","position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;"),t["bottom-left"].setAttribute("style","position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;"),t["bottom-center"].setAttribute("style","position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;"),t["bottom-right"].setAttribute("style","position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;"),o.setAttribute("style","position: sticky; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;");const r={externalOptions:{},state:null,memory:{},element:e,canvases:t,input:o,renderRequested:!1,mousePosition:null,isMouseDown:!1,columnWidthCache:new Map,rowHeightCache:new Map,requestNewRender:()=>{r.renderRequested||(r.renderRequested=!0,requestAnimationFrame((()=>{r.renderRequested=!1,Te(r),u(r)})))},addEventListener:(e,t,o)=>{e.addEventListener(t,(e=>{try{o(e)}catch(e){e.message=`[${t} event]: ${e.message}`,r.error=e,r.requestNewRender()}}))}};r.localOptions={data:[],columns:[{type:"DATA-BLOCK"}],rows:[{type:"HEADER"},{type:"DATA-BLOCK"}],formatting:[],filtering:[],sorting:[],dataSelector:({data:e,row:t,column:o})=>e[t.id][o.id],pinnedTop:0,pinnedBottom:0,pinnedLeft:0,pinnedRight:0,borderWidth:1,focusedCell:null,onFocusedCellChange:e=>{r.localOptions.focusedCell=e,r.requestNewRender()},selectedCells:[],onSelectedCellsChange:e=>{r.localOptions.selectedCells=e,r.requestNewRender()},highlightedCells:[],editedCells:[],onEditedCellsChange:e=>{r.localOptions.editedCells=e,r.requestNewRender()},filters:[],onFiltersChange:e=>{r.localOptions.filters=e,r.requestNewRender()},sortBy:[],onSortByChange:e=>{r.localOptions.sortBy=e,r.requestNewRender()},onCellClick:()=>{},onCustomCellClick:()=>{},columnWidths:[],onColumnWidthsChange:e=>{r.localOptions.columnWidths=e,r.requestNewRender()},rowHeights:[],onRowHeightsChange:e=>{r.localOptions.rowHeights=e,r.requestNewRender()}},e["spread-grid-context"]=r;const l=e=>{o.value=e,o.dispatchEvent(new Event("input"))},s=e=>{const t=r.state.options.selectedCells,o=r.state.inputFormatResolver,n=r.state.columnLookup,s=r.state.rowLookup,a=r.state.text,c=r.state.isTextValid,u=r.state.options.onEditedCellsChange,d=r.state.options.onFiltersChange,p=i(t,o,n,s);if(""===a)return;if(!c)return;if(e&&!p.every((e=>e.edit.autoCommit)))return;const h=p.filter((e=>"DATA"===e.type)),f=p.filter((e=>"FILTER"===e.type));var m;m=h.map((e=>({...e.cell,value:e.edit.parse({string:a})}))),u(Oe(r.state.options.editedCells,m)),(e=>{d(Oe(r.state.options.filters,e))})(f.map((e=>({...e.cell,expression:e.edit.parse({string:a})})))),e||l("")},a=e=>{const t=r.state.options.selectedCells,o=r.state.options.onEditedCellsChange,n=r.state.options.onFiltersChange,l=i(t,r.state.inputFormatResolver,r.state.columnLookup,r.state.rowLookup);var s;e&&!l.every((e=>e.edit.autoCommit))||(s=t,o(Le(r.state.options.editedCells,s)),(e=>{n(Le(r.state.options.filters,e))})(t))};r.addEventListener(e,"scroll",(e=>{r.requestNewRender()})),r.addEventListener(e,"mouseenter",(e=>{r.mousePosition=Pe(e),r.requestNewRender()})),r.addEventListener(e,"mousemove",(e=>{if(r.mousePosition=Pe(e),r.resizingColumn){const e=r.state.columnLookup.get(n(r.resizingColumn)),t=e.width,o=e.right,i=r.mousePosition.x,l=Math.max(10,i-o+t),s=r.state.options.columnWidths.filter((t=>n(t.columnId)!==e.key)).concat([{columnId:e.id,width:l}]);r.state.options.onColumnWidthsChange(s)}if(r.resizingRow){const e=r.state.rowLookup.get(n(r.resizingRow)),t=e.height,o=e.bottom,i=r.mousePosition.y,l=Math.max(10,i-o+t),s=r.state.options.rowHeights.filter((t=>n(t.rowId)!==e.key)).concat([{rowId:e.id,height:l}]);r.state.options.onRowHeightsChange(s)}r.requestNewRender()})),r.addEventListener(e,"mouseleave",(()=>{r.mousePosition=null,r.requestNewRender()})),r.addEventListener(e,"mousedown",(e=>{Te(r),l(""),r.isMouseDown=!0,r.mouseDownPosition=r.mousePosition,r.mouseDownCell=r.state.hoveredCell,r.state.resizableColumn&&(r.resizingColumn=r.state.resizableColumn),r.state.resizableRow&&(r.resizingRow=r.state.resizableRow),r.state.resizableColumn||r.state.resizableRow||r.state.options.onFocusedCellChange(r.state.hoveredCell),e.ctrlKey||r.state.options.onSelectedCellsChange([]),r.requestNewRender()})),r.addEventListener(e,"mouseup",(e=>{Te(r),r.isMouseDown=!1,r.resizingColumn=null,r.resizingRow=null,r.state.options.onSelectedCellsChange(Oe(r.state.options.selectedCells,r.state.highlightedCells)),r.requestNewRender()})),r.addEventListener(e,"pointerdown",(e=>{r.element.setPointerCapture(e.pointerId)})),r.addEventListener(e,"pointerup",(e=>{r.element.releasePointerCapture(e.pointerId)})),r.addEventListener(e,"click",(e=>{Te(r);const t=r.state.hoveredCell,o=r.mouseDownCell;if(r.state.resizableColumn||r.state.resizableRow)return;if(null===t)return;if(n(t.columnId)!==n(o.columnId))return;if(n(t.rowId)!==n(o.rowId))return;const i=r.state.columnLookup.get(n(t.columnId)),l=r.state.rowLookup.get(n(t.rowId)),s=r.state.options.sortBy;if("DATA"===i.type&&"DATA"===l.type)r.state.options.onCellClick(r.state.hoveredCell);else if("CUSTOM"===i.type||"CUSTOM"===l.type)r.state.options.onCustomCellClick(r.state.hoveredCell);else if("HEADER"===i.type||"HEADER"===l.type){const t=function(e,t,o,r){function i(e){return t.key===n(e.columnId||"HEADER")&&o.key===n(e.rowId||"HEADER")}const l=["ASC","DESC",void 0],s=e.find(i),a=l.indexOf(s?.direction),c=l[(a+1)%l.length],u=e.indexOf(s)===e.length-1;return[...!r||!u&&s?[]:e.filter((e=>!i(e))),...c?[{columnId:t.id,rowId:o.id,direction:c}]:[]]}(s,i,l,e.ctrlKey);r.state.options.onSortByChange(t),r.state.options.onSelectedCellsChange([])}})),r.addEventListener(e,"dblclick",(e=>{if(Te(r),r.state.resizableColumn){const e=n(r.state.resizableColumn),t=r.state.options.columnWidths.filter((t=>n(t.columnId)!==e));r.state.options.onColumnWidthsChange(t),r.columnWidthCache.delete(e)}if(r.state.resizableRow){const e=n(r.state.resizableRow),t=r.state.options.rowHeights.filter((t=>n(t.rowId)!==e));r.state.options.onRowHeightsChange(t),r.rowHeightCache.delete(e)}const t=r.state.focusedCell;if(null===t)return;const i=n(t.columnId),s=n(t.rowId),a=r.state.columnLookup,c=r.state.rowLookup,u=r.state.inputFormatResolver;if(!a.has(i))return;if(!c.has(s))return;const d=a.get(i),p=c.get(s),h=u.resolve(p,d).text;l(h),o?.select()})),r.addEventListener(e,"focus",(()=>{o.parentElement&&o.focus({preventScroll:!0})})),r.addEventListener(e,"keydown",(e=>{Te(r);const t=r.state.focusedCell,o=r.state.columnLookup,i=r.state.rowLookup,c=r.state.options.selectedCells,u=r.state.options.onSelectedCellsChange,d=r.state.options.onFocusedCellChange,p=r.state.options.editedCells,h=r.state.options.onEditedCellsChange,f=r.state.columns,m=r.state.rows,_=r.state.text,g=r.state.inputFormatResolver,y=(e,t)=>{d(e),t.shiftKey?u(Oe(c,[e])):u([e])},b=(e,r)=>{if(!t)return;const i=n(t.columnId);if(!o.has(i))return;const l=o.get(i).index,s=Math.max(0,Math.min(f.length-1,l+e));if(s===l)return;const a={rowId:t.rowId,columnId:f[s].id};y(a,r)},E=(e,o)=>{if(!t)return;const r=n(t.rowId);if(!i.has(r))return;const l=i.get(r).index,s=Math.max(0,Math.min(m.length-1,l+e));if(s===l)return;const a={rowId:m[s].id,columnId:t.columnId};y(a,o)},x=()=>{e.preventDefault(),e.stopPropagation()};switch(e.key){case"Escape":""!==_?l(""):c.length>1?u([t]):p.length>0?h([]):(d(null),u([]));break;case"Enter":s();break;case"ArrowUp":x(),E(e.ctrlKey?-m.length:-1,e);break;case"ArrowDown":x(),E(e.ctrlKey?m.length:1,e);break;case"ArrowLeft":x(),b(e.ctrlKey?-f.length:-1,e);break;case"ArrowRight":x(),b(e.ctrlKey?f.length:1,e);break;case"Delete":case"Backspace":a();break;case"c":(e=>{if(!e.ctrlKey)return;const t=function(e,t,o,r){const i=new Map(t.map((e=>[e.key,e]))),l=new Map(o.map((e=>[e.key,e]))),s=e.map((e=>({columnKey:n(e.columnId),rowKey:n(e.rowId)}))).filter((e=>i.has(e.columnKey)&&l.has(e.rowKey))),a=new Set(s.map((e=>e.columnKey))),c=new Set(s.map((e=>e.rowKey)));if(0===s.length)return"";const u=new w(e),d=Math.min(...s.map((e=>i.get(e.columnKey).index))),p=Math.max(...s.map((e=>i.get(e.columnKey).index))),h=Math.min(...s.map((e=>l.get(e.rowKey).index))),f=Math.max(...s.map((e=>l.get(e.rowKey).index))),m=[];for(let e=h;e<=f;e++){const n=o[e],i=n.key;if(c.has(i)){for(let e=d;e<=p;e++){const o=t[e],l=o.key;if(a.has(l)){if(u.isKeySelected(i,l)){const e=r.resolve(n,o).text;m.push(e)}e<p&&m.push("\t")}}e<f&&m.push("\n")}}return m.join("")}(c,f,m,g);if(navigator.clipboard)navigator.clipboard.writeText(t);else{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}})(e)}})),new ResizeObserver((()=>{r.requestNewRender()})).observe(e),r.addEventListener(o,"input",(e=>{Te(r),e.target.value?(s(!0),o.style.opacity=1,o.style.pointerEvents="auto"):(e.isTrusted&&a(!0),o.style.opacity=0,o.style.pointerEvents="none")})),r.addEventListener(o,"click",(e=>{e.stopPropagation()})),r.addEventListener(o,"dblclick",(e=>{e.stopPropagation()})),r.addEventListener(o,"mousedown",(e=>{e.stopPropagation()})),r.addEventListener(o,"keydown",(e=>{switch(e.key){case"Enter":case"Escape":break;case"Delete":case"Backspace":case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":""!==o.value&&(e.stopPropagation(),r.requestNewRender());break;default:e.stopPropagation(),r.requestNewRender()}}))}function Se(e,t){console.log("createGrid"),Be(e);const o=e["spread-grid-context"];o.externalOptions=t,null===o.state?(Te(o),u(o)):o.requestNewRender()}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var getCurrentScript=function(){var e=document.currentScript;if(!e){for(var t=document.getElementsByTagName("script"),o=[],n=0;n<t.length;n++)o.push(t[n]);e=(o=o.filter((function(e){return!e.async&&!e.text&&!e.textContent}))).slice(-1)[0]}return e},isLocalScript=function(e){return/\/_dash-component-suites\//.test(e.src)},url;if(Object.defineProperty(__webpack_require__,"p",{get:(url=getCurrentScript().src.split("/").slice(0,-1).join("/")+"/",function(){return url})}),"undefined"!=typeof jsonpScriptSrc){var __jsonpScriptSrc__=jsonpScriptSrc;jsonpScriptSrc=function(e){var t=getCurrentScript(),o=isLocalScript(t),n=__jsonpScriptSrc__(e);if(!o)return n;var r=n.split("/"),i=r.slice(-1)[0].split(".");return i.splice(1,0,"v0_0_5m1712488437"),r.splice(-1,1,i.join(".")),r.join("/")}}var __webpack_exports__={};(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DashSpreadGrid:()=>e.Z});var e=__webpack_require__(353)})(),window.dash_spread_grid=__webpack_exports__})();
//# sourceMappingURL=dash_spread_grid.min.js.map