"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[9046],{34160:(t,e,s)=>{s.d(e,{m:()=>i});var i,n=s(92279),a=s(71204);!function(t){t.getBoolean=function(t){return(0,a.vC)({...t,body:new r(t),buttons:[a.Vq.cancelButton({label:t.cancelLabel}),a.Vq.okButton({label:t.okLabel})],focusNodeSelector:"input"})},t.getNumber=function(t){return(0,a.vC)({...t,body:new h(t),buttons:[a.Vq.cancelButton({label:t.cancelLabel}),a.Vq.okButton({label:t.okLabel})],focusNodeSelector:"input"})},t.getItem=function(t){return(0,a.vC)({...t,body:new d(t),buttons:[a.Vq.cancelButton({label:t.cancelLabel}),a.Vq.okButton({label:t.okLabel})],focusNodeSelector:t.editable?"input":"select"})},t.getMultipleItems=function(t){return(0,a.vC)({...t,body:new u(t),buttons:[a.Vq.cancelButton({label:t.cancelLabel}),a.Vq.okButton({label:t.okLabel})]})},t.getText=function(t){return(0,a.vC)({...t,body:new l(t),buttons:[a.Vq.cancelButton({label:t.cancelLabel}),a.Vq.okButton({label:t.okLabel})],focusNodeSelector:"input"})},t.getPassword=function(t){return(0,a.vC)({...t,body:new c(t),buttons:[a.Vq.cancelButton({label:t.cancelLabel}),a.Vq.okButton({label:t.okLabel})],focusNodeSelector:"input"})}}(i||(i={}));class o extends n.$L{constructor(t){if(super(),this.addClass("jp-Input-Dialog"),this._input=document.createElement("input"),this._input.classList.add("jp-mod-styled"),this._input.id="jp-dialog-input-id",void 0!==t){const e=document.createElement("label");e.textContent=t,e.htmlFor=this._input.id,this.node.appendChild(e)}this.node.appendChild(this._input)}}class r extends o{constructor(t){super(t.label),this.addClass("jp-Input-Boolean-Dialog"),this._input.type="checkbox",this._input.checked=!!t.value}getValue(){return this._input.checked}}class h extends o{constructor(t){super(t.label),this._input.type="number",this._input.value=t.value?t.value.toString():"0"}getValue(){return this._input.value?Number(this._input.value):Number.NaN}}class l extends o{constructor(t){var e;super(t.label),this._input.type="text",this._input.value=t.text?t.text:"",t.placeholder&&(this._input.placeholder=t.placeholder),this._initialSelectionRange=Math.min(this._input.value.length,Math.max(0,null!==(e=t.selectionRange)&&void 0!==e?e:this._input.value.length))}onAfterAttach(t){super.onAfterAttach(t),this._initialSelectionRange>0&&this._input.value&&this._input.setSelectionRange(0,this._initialSelectionRange)}getValue(){return this._input.value}}class c extends o{constructor(t){super(t.label),this._input.type="password",this._input.value=t.text?t.text:"",t.placeholder&&(this._input.placeholder=t.placeholder)}onAfterAttach(t){super.onAfterAttach(t),this._input.value&&this._input.select()}getValue(){return this._input.value}}class d extends o{constructor(t){super(t.label),this._editable=t.editable||!1;let e,s=t.current||0;if("number"==typeof s&&(e=Math.max(0,Math.min(s,t.items.length-1)),s=""),this._list=document.createElement("select"),t.items.forEach(((t,i)=>{const n=document.createElement("option");i===e&&(n.selected=!0,s=t),n.value=t,n.textContent=t,this._list.appendChild(n)})),t.editable){const e=document.createElement("datalist");e.id="input-dialog-items",e.appendChild(this._list),this._input.type="list",this._input.value=s,this._input.setAttribute("list",e.id),t.placeholder&&(this._input.placeholder=t.placeholder),this.node.appendChild(e)}else this._input.remove(),this.node.appendChild(this._list)}getValue(){return this._editable?this._input.value:this._list.value}}class u extends o{constructor(t){super(t.label);let e=t.defaults||[];this._list=document.createElement("select"),this._list.setAttribute("multiple",""),t.items.forEach((t=>{const e=document.createElement("option");e.value=t,e.textContent=t,this._list.appendChild(e)})),this._input.remove(),this.node.appendChild(this._list);const s=this._list.options;for(let t=0;t<s.length;t++){const i=s[t];e.includes(i.value)?i.selected=!0:i.selected=!1}}getValue(){let t=[];for(let e of this._list.options)e.selected&&!e.classList.contains("hidden")&&t.push(e.value||e.text);return t}}},53950:(t,e,s)=>{s.d(e,{P:()=>i});var i,n=s(47963),a=s(98209);class o{constructor(){this._isDisposed=!1,this._queue=[],this._changed=new a.Signal(this)}get changed(){return this._changed}get count(){return this._queue.length}get isDisposed(){return this._isDisposed}get notifications(){return this._queue.slice()}dismiss(t){if(void 0===t){const t=this._queue.slice();this._queue.length=0;for(const e of t)this._changed.emit({type:"removed",notification:e})}else{const e=this._queue.findIndex((e=>e.id===t));if(e>-1){const t=this._queue.splice(e,1)[0];this._changed.emit({type:"removed",notification:t})}}}dispose(){this._isDisposed||(this._isDisposed=!0,a.Signal.clearData(this))}has(t){return this._queue.findIndex((e=>e.id===t))>-1}notify(t,e,s){const i=Date.now(),{progress:a,...o}=s,r=Object.freeze({id:n.UUID.uuid4(),createdAt:i,modifiedAt:i,message:t,type:e,options:{autoClose:0,progress:"number"==typeof a?Math.min(Math.max(0,a),1):a,...o}});return this._queue.unshift(r),this._changed.emit({type:"added",notification:r}),r.id}update(t){const{id:e,message:s,actions:i,autoClose:n,data:a,progress:o,type:r}=t,h="number"==typeof o?Math.min(Math.max(0,o),1):o,l=this._queue.findIndex((t=>t.id===e));if(l>-1){const t=this._queue[l],e=Object.freeze({...t,message:null!=s?s:t.message,type:null!=r?r:t.type,options:{actions:null!=i?i:t.options.actions,autoClose:null!=n?n:t.options.autoClose,data:null!=a?a:t.options.data,progress:null!=h?h:t.options.progress},modifiedAt:Date.now()});return this._queue.splice(l,1),this._queue.unshift(e),this._changed.emit({type:"updated",notification:e}),!0}return!1}}!function(t){t.manager=new o,t.dismiss=function(e){t.manager.dismiss(e)},t.emit=function(e,s="default",i={}){return t.manager.notify(e,s,i)},t.error=function(e,s={}){return t.manager.notify(e,"error",s)},t.info=function(e,s={}){return t.manager.notify(e,"info",s)},t.promise=function(e,s){var i;const{pending:n,error:a,success:o}=s,r=t.manager.notify(n.message,"in-progress",null!==(i=n.options)&&void 0!==i?i:{});return e.then((e=>{var s,i,n;t.manager.update({id:r,message:o.message(e,null===(s=o.options)||void 0===s?void 0:s.data),type:"success",...o.options,data:null!==(n=null===(i=o.options)||void 0===i?void 0:i.data)&&void 0!==n?n:e})})).catch((e=>{var s,i,n;t.manager.update({id:r,message:a.message(e,null===(s=a.options)||void 0===s?void 0:s.data),type:"error",...a.options,data:null!==(n=null===(i=a.options)||void 0===i?void 0:i.data)&&void 0!==n?n:e})})),r},t.success=function(e,s={}){return t.manager.notify(e,"success",s)},t.update=function(e){return t.manager.update(e)},t.warning=function(e,s={}){return t.manager.notify(e,"warning",s)}}(i||(i={}))},26855:(t,e,s)=>{s.d(e,{B2:()=>c,eT:()=>d,gQ:()=>l,oQ:()=>h});var i,n=s(71204),a=s(48425),o=s(18168),r=s(92279);function h(t,e,s){const i=(s=s||o.Sr).load("jupyterlab"),a=e.localPath.split("/").pop()||e.localPath;return(0,n.vC)({title:i.__("Rename File"),body:new u(a),focusNodeSelector:"input",buttons:[n.Vq.cancelButton(),n.Vq.okButton({label:i.__("Rename"),ariaLabel:i.__("Rename File")})]}).then((t=>t.value?d(t.value)?e.rename(t.value):((0,n.UW)(i.__("Rename Error"),Error(i.__('"%1" is not a valid name for a file. Names must have nonzero length, and cannot include "/", "\\", or ":"',t.value))),null):null))}function l(t,e,s){return t.rename(e,s).catch((i=>{if(409!==i.response.status)throw i;return c(s).then((i=>i?t.overwrite(e,s):Promise.reject("File not renamed")))}))}function c(t,e){const s=(e=e||o.Sr).load("jupyterlab"),i={title:s.__("Overwrite file?"),body:s.__('"%1" already exists, overwrite?',t),buttons:[n.Vq.cancelButton(),n.Vq.warnButton({label:s.__("Overwrite"),ariaLabel:s.__("Overwrite Existing File")})]};return(0,n.vC)(i).then((t=>Promise.resolve(t.button.accept)))}function d(t){return t.length>0&&!/[\/\\:]/.test(t)}class u extends r.$L{constructor(t){super({node:i.createRenameNode(t)}),this.addClass("jp-FileDialog");const e=a.PathExt.extname(t),s=this.inputNode.value=a.PathExt.basename(t);this.inputNode.setSelectionRange(0,s.length-e.length)}get inputNode(){return this.node.getElementsByTagName("input")[0]}getValue(){return this.inputNode.value}}!function(t){t.createRenameNode=function(t,e){const s=(e=e||o.Sr).load("jupyterlab"),i=document.createElement("div"),n=document.createElement("label");n.textContent=s.__("File Path");const a=document.createElement("span");a.textContent=t;const r=document.createElement("label");r.textContent=s.__("New Name"),r.className="jp-new-name-title";const h=document.createElement("input");return i.appendChild(n),i.appendChild(a),i.appendChild(r),i.appendChild(h),i}}(i||(i={}))},85414:(t,e,s)=>{s.d(e,{V:()=>w});var i,n=s(99190),a=s(48425),o=s(71204),r=s(81631),h=s(18168),l=s(47963),c=s(16781),d=s(98209),u=s(92279);class _{constructor(t){var e,s;this._isReady=!1,this._isDisposed=!1,this._isPopulated=!1,this._path="",this._lineEnding=null,this._contentsModel=null,this._populatedPromise=new l.PromiseDelegate,this._pathChanged=new d.Signal(this),this._fileChanged=new d.Signal(this),this._saveState=new d.Signal(this),this._disposed=new d.Signal(this),this._lastModifiedCheckMargin=500,this._conflictModalIsOpen=!1;const o=this._manager=t.manager;this.translator=t.translator||h.Sr,this._trans=this.translator.load("jupyterlab"),this._factory=t.factory,this._dialogs=null!==(e=t.sessionDialogs)&&void 0!==e?e:new n.H({translator:t.translator}),this._opener=t.opener||i.noOp,this._path=this._manager.contents.normalize(t.path),this._lastModifiedCheckMargin=t.lastModifiedCheckMargin||500;const c=this._manager.contents.localPath(this._path),u=this._factory.preferredLanguage(a.PathExt.basename(c)),_=this._manager.contents.getSharedModelFactory(this._path),p=null==_?void 0:_.createNew({path:c,format:this._factory.fileFormat,contentType:this._factory.contentType,collaborative:this._factory.collaborative});this._model=this._factory.createNew({languagePreference:u,sharedModel:p,collaborationEnabled:null!==(s=null==_?void 0:_.collaborative)&&void 0!==s&&s}),this._readyPromise=o.ready.then((()=>this._populatedPromise.promise));const g=a.PathExt.extname(this._path);this.sessionContext=new n.B({sessionManager:o.sessions,specsManager:o.kernelspecs,path:c,type:".ipynb"===g?"notebook":"file",name:a.PathExt.basename(c),kernelPreference:t.kernelPreference||{shouldStart:!1},setBusy:t.setBusy}),this.sessionContext.propertyChanged.connect(this._onSessionChanged,this),o.contents.fileChanged.connect(this._onFileChanged,this),this.urlResolver=new r.D.UrlResolver({path:this._path,contents:o.contents})}get pathChanged(){return this._pathChanged}get fileChanged(){return this._fileChanged}get saveState(){return this._saveState}get disposed(){return this._disposed}get lastModifiedCheckMargin(){return this._lastModifiedCheckMargin}set lastModifiedCheckMargin(t){this._lastModifiedCheckMargin=t}get model(){return this._model}get path(){return this._path}get localPath(){return this._manager.contents.localPath(this._path)}get contentsModel(){return this._contentsModel?{...this._contentsModel}:null}get factoryName(){return this.isDisposed?"":this._factory.name}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this.sessionContext.dispose(),this._model.dispose(),this._model.sharedModel.dispose(),this._disposed.emit(void 0),d.Signal.clearData(this))}get isReady(){return this._isReady}get ready(){return this._readyPromise}get canSave(){var t;return!(!(null===(t=this._contentsModel)||void 0===t?void 0:t.writable)||this._model.collaborative)}async initialize(t){t?await this._save():await this._revert(),this.model.sharedModel.clearUndoHistory()}rename(t){return this.ready.then((()=>this._manager.ready.then((()=>this._rename(t)))))}async save(){await this.ready,await this._save()}async saveAs(){await this.ready;const t=this._manager.contents.localPath(this.path),e=await i.getSavePath(t);if(this.isDisposed||!e)return;const s=this._manager.contents.driveName(this.path),n=""==s?e:`${s}:${e}`;if(n===this._path)return this.save();try{await this._manager.ready,await this._manager.contents.get(n),await this._maybeOverWrite(n)}catch(t){if(!t.response||404!==t.response.status)throw t;await this._finishSaveAs(n)}}async download(){const t=await this._manager.contents.getDownloadUrl(this._path),e=document.createElement("a");e.href=t,e.download="",document.body.appendChild(e),e.click(),document.body.removeChild(e)}async revert(){await this.ready,await this._revert()}createCheckpoint(){const t=this._manager.contents;return this._manager.ready.then((()=>t.createCheckpoint(this._path)))}deleteCheckpoint(t){const e=this._manager.contents;return this._manager.ready.then((()=>e.deleteCheckpoint(this._path,t)))}restoreCheckpoint(t){const e=this._manager.contents,s=this._path;return this._manager.ready.then((()=>t?e.restoreCheckpoint(s,t):this.listCheckpoints().then((i=>{if(!this.isDisposed&&i.length)return t=i[i.length-1].id,e.restoreCheckpoint(s,t)}))))}listCheckpoints(){const t=this._manager.contents;return this._manager.ready.then((()=>t.listCheckpoints(this._path)))}addSibling(t,e={}){const s=this._opener;return s&&s(t,e),new c.DisposableDelegate((()=>{t.close()}))}_onFileChanged(t,e){var s;if("rename"!==e.type)return;let i=e.oldValue&&e.oldValue.path,n=e.newValue&&e.newValue.path;if(n&&0===this._path.indexOf(i||"")){let t=e.newValue;i!==this._path&&(n=this._path.replace(new RegExp(`^${i}/`),`${n}/`),i=this._path,t={last_modified:null===(s=e.newValue)||void 0===s?void 0:s.created,path:n}),this._updateContentsModel({...this._contentsModel,...t}),this._updatePath(n)}}_onSessionChanged(t,e){if("path"!==e)return;const s=this._manager.contents.driveName(this.path);let i=this.sessionContext.session.path;s&&(i=`${s}:${i}`),this._updatePath(i)}_updateContentsModel(t){var e,s,i,n;const a=t.writable&&!this._model.collaborative,o={path:t.path,name:t.name,type:t.type,writable:a,created:t.created,last_modified:t.last_modified,mimetype:t.mimetype,format:t.format,hash:t.hash,hash_algorithm:t.hash_algorithm},r=null!==(s=null===(e=this._contentsModel)||void 0===e?void 0:e.last_modified)&&void 0!==s?s:null,h=null!==(n=null===(i=this._contentsModel)||void 0===i?void 0:i.hash)&&void 0!==n?n:null;this._contentsModel=o,(!r&&!h||!h&&o.last_modified!==r||h&&o.hash!==h)&&this._fileChanged.emit(o)}_updatePath(t){var e,s,i,n;if(this._path===t)return;this._path=t;const o=this._manager.contents.localPath(t),r=a.PathExt.basename(o);if((null===(e=this.sessionContext.session)||void 0===e?void 0:e.path)!==o&&(null===(s=this.sessionContext.session)||void 0===s||s.setPath(o)),(null===(i=this.sessionContext.session)||void 0===i?void 0:i.name)!==r&&(null===(n=this.sessionContext.session)||void 0===n||n.setName(r)),this.urlResolver.path!==t&&(this.urlResolver.path=t),this._contentsModel&&(this._contentsModel.path!==t||this._contentsModel.name!==r)){const e={...this._contentsModel,name:r,path:t};this._updateContentsModel(e)}this._pathChanged.emit(t)}async _populate(){if(this._isPopulated=!0,this._isReady=!0,this._populatedPromise.resolve(void 0),await this._maybeCheckpoint(!1),this.isDisposed)return;const t=this._model.defaultKernelName||this.sessionContext.kernelPreference.name;this.sessionContext.kernelPreference={...this.sessionContext.kernelPreference,name:t,language:this._model.defaultKernelLanguage},this.sessionContext.initialize().then((t=>{t&&this._dialogs.selectKernel(this.sessionContext)}))}async _rename(t){const e=this.localPath.split("/");e[e.length-1]=t;let s=a.PathExt.join(...e);const i=this._manager.contents.driveName(this.path);i&&(s=`${i}:${s}`),await this._manager.contents.rename(this.path,s)}async _save(){this._saveState.emit("started");const t=this._createSaveOptions();try{await this._manager.ready;const e=await this._maybeSave(t);if(this.isDisposed)return;this._model.dirty=!1,this._updateContentsModel(e),this._isPopulated||await this._populate(),this._saveState.emit("completed")}catch(t){const{name:e}=t;if("ModalCancelError"===e||"ModalDuplicateError"===e)throw t;const s=this._manager.contents.localPath(this._path),i=a.PathExt.basename(s);throw this._handleError(t,this._trans.__("File Save Error for %1",i)),this._saveState.emit("failed"),t}}_revert(t=!1){const e={type:this._factory.contentType,content:null!==this._factory.fileFormat,hash:null!==this._factory.fileFormat,...null!==this._factory.fileFormat?{format:this._factory.fileFormat}:{}},s=this._path,i=this._model;return this._manager.ready.then((()=>this._manager.contents.get(s,e))).then((t=>{if(!this.isDisposed){if(t.content)if("json"===t.format)i.fromJSON(t.content);else{let e=t.content;-1!==e.indexOf("\r\n")?(this._lineEnding="\r\n",e=e.replace(/\r\n/g,"\n")):-1!==e.indexOf("\r")?(this._lineEnding="\r",e=e.replace(/\r/g,"\n")):this._lineEnding=null,i.fromString(e)}return this._updateContentsModel(t),i.dirty=!1,this._isPopulated?void 0:this._populate()}})).catch((async t=>{const e=this._manager.contents.localPath(this._path),s=a.PathExt.basename(e);throw this._handleError(t,this._trans.__("File Load Error for %1",s)),t}))}_maybeSave(t){const e=this._path;return this._manager.contents.get(e,{content:!1,hash:!0}).then((s=>{var i,n,a,o;if(this.isDisposed)return Promise.reject(new Error("Disposed"));const r=void 0!==(null===(i=this.contentsModel)||void 0===i?void 0:i.hash)&&null!==(null===(n=this.contentsModel)||void 0===n?void 0:n.hash)&&void 0!==s.hash&&null!==s.hash,h=null===(a=this.contentsModel)||void 0===a?void 0:a.hash,l=s.hash;if(r&&h!==l)return console.warn(`Different hash found for ${this.path}`),this._raiseConflict(s,t);const c=this._lastModifiedCheckMargin,d=null===(o=this.contentsModel)||void 0===o?void 0:o.last_modified,u=d?new Date(d):new Date,_=new Date(s.last_modified);return!r&&d&&_.getTime()-u.getTime()>c?(console.warn(`Last saving performed ${u} while the current file seems to have been saved ${_}`),this._raiseConflict(s,t)):this._manager.contents.save(e,t).then((async t=>{const s=await this._manager.contents.get(e,{content:!1,hash:!0});return{...t,hash:s.hash,hash_algorithm:s.hash_algorithm}}))}),(s=>{if(s.response&&404===s.response.status)return this._manager.contents.save(e,t).then((async t=>{const s=await this._manager.contents.get(e,{content:!1,hash:!0});return{...t,hash:s.hash,hash_algorithm:s.hash_algorithm}}));throw s}))}async _handleError(t,e){await(0,o.UW)(e,t)}_maybeCheckpoint(t){let e=Promise.resolve(void 0);return this.canSave?(e=t?this.createCheckpoint().then():this.listCheckpoints().then((t=>{if(!this.isDisposed&&!t.length&&this.canSave)return this.createCheckpoint().then()})),e.catch((t=>{if(!t.response||403!==t.response.status)throw t}))):e}_raiseConflict(t,e){if(this._conflictModalIsOpen){const t=new Error("Modal is already displayed");return t.name="ModalDuplicateError",Promise.reject(t)}const s=this._trans.__('"%1" has changed on disk since the last time it was opened or saved.\nDo you want to overwrite the file on disk with the version open here,\nor load the version on disk (revert)?',this.path),i=o.Vq.okButton({label:this._trans.__("Revert"),actions:["revert"]}),n=o.Vq.warnButton({label:this._trans.__("Overwrite"),actions:["overwrite"]});return this._conflictModalIsOpen=!0,(0,o.vC)({title:this._trans.__("File Changed"),body:s,buttons:[o.Vq.cancelButton(),i,n]}).then((s=>{if(this._conflictModalIsOpen=!1,this.isDisposed)return Promise.reject(new Error("Disposed"));if(s.button.actions.includes("overwrite"))return this._manager.contents.save(this._path,e);if(s.button.actions.includes("revert"))return this.revert().then((()=>t));const i=new Error("Cancel");return i.name="ModalCancelError",Promise.reject(i)}))}_maybeOverWrite(t){const e=this._trans.__('"%1" already exists. Do you want to replace it?',t),s=o.Vq.warnButton({label:this._trans.__("Overwrite"),accept:!0});return(0,o.vC)({title:this._trans.__("File Overwrite?"),body:e,buttons:[o.Vq.cancelButton(),s]}).then((e=>this.isDisposed?Promise.reject(new Error("Disposed")):e.button.accept?this._manager.contents.delete(t).then((()=>this._finishSaveAs(t))):void 0))}async _finishSaveAs(t){this._saveState.emit("started");try{await this._manager.ready;const e=this._createSaveOptions();await this._manager.contents.save(t,e),await this._maybeCheckpoint(!0),this._saveState.emit("completed")}catch(t){if("Cancel"===t.message||"Modal is already displayed"===t.message)throw t;const e=this._manager.contents.localPath(this._path),s=a.PathExt.basename(e);return this._handleError(t,this._trans.__("File Save Error for %1",s)),void this._saveState.emit("failed")}}_createSaveOptions(){let t=null;return"json"===this._factory.fileFormat?t=this._model.toJSON():(t=this._model.toString(),this._lineEnding&&(t=t.replace(/\n/g,this._lineEnding))),{type:this._factory.contentType,format:this._factory.fileFormat,content:t}}}!function(t){t.getSavePath=function(t,s){const i=(s=s||h.Sr).load("jupyterlab"),n=o.Vq.okButton({label:i.__("Save"),accept:!0});return(0,o.vC)({title:i.__("Save File Asâ€¦"),body:new e(t),buttons:[o.Vq.cancelButton(),n]}).then((t=>{var e;if(t.button.accept)return null!==(e=t.value)&&void 0!==e?e:void 0}))},t.noOp=function(){};class e extends u.$L{constructor(t){super({node:s(t)})}getValue(){return this.node.value}}function s(t){const e=document.createElement("input");return e.value=t,e}}(i||(i={}));var p=s(46931),g=s(41835);class m{constructor(t){this._autosaveTimer=-1,this._minInterval=-1,this._interval=-1,this._isActive=!1,this._inDialog=!1,this._isDisposed=!1,this._multiplier=10,this._context=t.context,this._isConnectedCallback=t.isConnectedCallback||(()=>!0);const e=t.saveInterval||120;this._minInterval=1e3*e,this._interval=this._minInterval,this._context.fileChanged.connect(this._setTimer,this),this._context.disposed.connect(this.dispose,this)}get saveInterval(){return this._interval/1e3}set saveInterval(t){this._minInterval=this._interval=1e3*t,this._isActive&&this._setTimer()}get isActive(){return this._isActive}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,clearTimeout(this._autosaveTimer),d.Signal.clearData(this))}start(){this._isActive=!0,this._setTimer()}stop(){this._isActive=!1,clearTimeout(this._autosaveTimer)}_setTimer(){clearTimeout(this._autosaveTimer),this._isActive&&(this._autosaveTimer=window.setTimeout((()=>{this._isConnectedCallback()&&this._save()}),this._interval))}_save(){const t=this._context;if(this._setTimer(),!t)return;if(!t.contentsModel||!t.contentsModel.writable||!t.model.dirty||this._inDialog)return;const e=(new Date).getTime();t.save().then((()=>{if(this.isDisposed)return;const t=(new Date).getTime()-e;this._interval=Math.max(this._multiplier*t,this._minInterval),this._setTimer()})).catch((t=>{const{name:e}=t;"ModalCancelError"!==e&&"ModalDuplicateError"!==e&&console.error("Error in Auto-Save",t.message)}))}}var v,f,y=s(37158);class C{constructor(t){this._activateRequested=new d.Signal(this),this._confirmClosingTab=!1,this._isDisposed=!1,this._stateChanged=new d.Signal(this),this._registry=t.registry,this.translator=t.translator||h.Sr}get activateRequested(){return this._activateRequested}get confirmClosingDocument(){return this._confirmClosingTab}set confirmClosingDocument(t){if(this._confirmClosingTab!==t){const e=this._confirmClosingTab;this._confirmClosingTab=t,this._stateChanged.emit({name:"confirmClosingDocument",oldValue:e,newValue:t})}}get stateChanged(){return this._stateChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,d.Signal.disconnectReceiver(this))}createWidget(t,e){const s=t.createNew(e);return this._initializeWidget(s,t,e),s}_initializeWidget(t,e,s){v.factoryProperty.set(t,e);const i=new c.DisposableSet;for(const n of this._registry.widgetExtensions(e.name)){const e=n.createNew(t,s);e&&i.add(e)}v.disposablesProperty.set(t,i),t.disposed.connect(this._onWidgetDisposed,this),this.adoptWidget(s,t),s.fileChanged.connect(this._onFileChanged,this),s.pathChanged.connect(this._onPathChanged,this),s.ready.then((()=>{this.setCaption(t)}))}adoptWidget(t,e){v.widgetsProperty.get(t).push(e),y.pB.installMessageHook(e,this),e.addClass("jp-Document"),e.title.closable=!0,e.disposed.connect(this._widgetDisposed,this),v.contextProperty.set(e,t)}findWidget(t,e){const s=v.widgetsProperty.get(t);if(s)return(0,p.sE)(s,(t=>{const s=v.factoryProperty.get(t);return!!s&&s.name===e}))}contextForWidget(t){return v.contextProperty.get(t)}cloneWidget(t){const e=v.contextProperty.get(t);if(!e)return;const s=v.factoryProperty.get(t);if(!s)return;const i=s.createNew(e,t);return this._initializeWidget(i,s,e),i}closeWidgets(t){const e=v.widgetsProperty.get(t);return Promise.all(e.map((t=>this.onClose(t)))).then((()=>{}))}deleteWidgets(t){const e=v.widgetsProperty.get(t);return Promise.all(e.map((t=>this.onDelete(t)))).then((()=>{}))}messageHook(t,e){switch(e.type){case"close-request":return this.onClose(t),!1;case"activate-request":{const e=this.contextForWidget(t);e&&this._activateRequested.emit(e.path);break}}return!0}async setCaption(t){const e=this.translator.load("jupyterlab"),s=v.contextProperty.get(t);if(!s)return;const i=s.contentsModel;if(i)return s.listCheckpoints().then((n=>{if(t.isDisposed)return;const o=n[n.length-1],r=o?a.Time.format(o.last_modified):"None";let h=e.__("Name: %1\nPath: %2\n",i.name,i.path);s.model.readOnly?h+=e.__("Read-only"):h+=e.__("Last Saved: %1\n",a.Time.format(i.last_modified))+e.__("Last Checkpoint: %1",r),t.title.caption=h}));t.title.caption=""}async onClose(t){var e;const[s,i]=await this._maybeClose(t,this.translator);if(t.isDisposed)return!0;if(s){if(!i){const s=v.contextProperty.get(t);if(!s)return!0;(null===(e=s.contentsModel)||void 0===e?void 0:e.writable)?await s.save():await s.saveAs()}if(t.isDisposed)return!0;t.dispose()}return s}onDelete(t){return t.dispose(),Promise.resolve(void 0)}async _maybeClose(t,e){var s,i;const n=(e=e||h.Sr).load("jupyterlab"),a=v.contextProperty.get(t);if(!a)return Promise.resolve([!0,!0]);let r=v.widgetsProperty.get(a);if(!r)return Promise.resolve([!0,!0]);r=r.filter((t=>{const e=v.factoryProperty.get(t);return!!e&&!1===e.readOnly}));const l=t.title.label,c=v.factoryProperty.get(t),d=a.model.dirty&&r.length<=1&&!(null===(s=null==c?void 0:c.readOnly)||void 0===s||s);if(this.confirmClosingDocument){const t=[o.Vq.cancelButton(),o.Vq.okButton({label:d?n.__("Close and save"):n.__("Close"),ariaLabel:d?n.__("Close and save Document"):n.__("Close Document")})];d&&t.splice(1,0,o.Vq.warnButton({label:n.__("Close without saving"),ariaLabel:n.__("Close Document without saving")}));const e=await(0,o.vC)({title:n.__("Confirmation"),body:n.__('Please confirm you want to close "%1".',l),checkbox:d?null:{label:n.__("Do not ask me again."),caption:n.__("If checked, no confirmation to close a document will be asked in the future.")},buttons:t});return e.isChecked&&(this.confirmClosingDocument=!1),Promise.resolve([e.button.accept,!d||"warn"===e.button.displayType])}{if(!d)return Promise.resolve([!0,!0]);const t=(null===(i=a.contentsModel)||void 0===i?void 0:i.writable)?n.__("Save"):n.__("Save as"),e=await(0,o.vC)({title:n.__("Save your work"),body:n.__('Save changes in "%1" before closing?',l),buttons:[o.Vq.cancelButton(),o.Vq.warnButton({label:n.__("Discard"),ariaLabel:n.__("Discard changes to file")}),o.Vq.okButton({label:t})]});return[e.button.accept,"warn"===e.button.displayType]}}_widgetDisposed(t){const e=v.contextProperty.get(t);if(!e)return;const s=v.widgetsProperty.get(e);s&&(p.RO.removeFirstOf(s,t),s.length||e.dispose())}_onWidgetDisposed(t){v.disposablesProperty.get(t).dispose()}_onFileChanged(t){const e=v.widgetsProperty.get(t);for(const t of e)this.setCaption(t)}_onPathChanged(t){const e=v.widgetsProperty.get(t);for(const t of e)this.setCaption(t)}}!function(t){t.contextProperty=new g.AttachedProperty({name:"context",create:()=>{}}),t.factoryProperty=new g.AttachedProperty({name:"factory",create:()=>{}}),t.widgetsProperty=new g.AttachedProperty({name:"widgets",create:()=>[]}),t.disposablesProperty=new g.AttachedProperty({name:"disposables",create:()=>new c.DisposableSet})}(v||(v={}));class w{constructor(t){var e;this._activateRequested=new d.Signal(this),this._contexts=[],this._isDisposed=!1,this._autosave=!0,this._autosaveInterval=120,this._lastModifiedCheckMargin=500,this._renameUntitledFileOnSave=!0,this._stateChanged=new d.Signal(this),this.translator=t.translator||h.Sr,this.registry=t.registry,this.services=t.manager,this._dialogs=null!==(e=t.sessionDialogs)&&void 0!==e?e:new n.H({translator:t.translator}),this._isConnectedCallback=t.isConnectedCallback||(()=>!0),this._opener=t.opener,this._when=t.when||t.manager.ready;const s=new C({registry:this.registry,translator:this.translator});s.activateRequested.connect(this._onActivateRequested,this),s.stateChanged.connect(this._onWidgetStateChanged,this),this._widgetManager=s,this._setBusy=t.setBusy}get activateRequested(){return this._activateRequested}get autosave(){return this._autosave}set autosave(t){if(this._autosave!==t){const e=this._autosave;this._autosave=t,this._contexts.forEach((e=>{const s=f.saveHandlerProperty.get(e);s&&(!0!==t||s.isActive?!1===t&&s.isActive&&s.stop():s.start())})),this._stateChanged.emit({name:"autosave",oldValue:e,newValue:t})}}get autosaveInterval(){return this._autosaveInterval}set autosaveInterval(t){if(this._autosaveInterval!==t){const e=this._autosaveInterval;this._autosaveInterval=t,this._contexts.forEach((e=>{const s=f.saveHandlerProperty.get(e);s&&(s.saveInterval=t||120)})),this._stateChanged.emit({name:"autosaveInterval",oldValue:e,newValue:t})}}get confirmClosingDocument(){return this._widgetManager.confirmClosingDocument}set confirmClosingDocument(t){if(this._widgetManager.confirmClosingDocument!==t){const e=this._widgetManager.confirmClosingDocument;this._widgetManager.confirmClosingDocument=t,this._stateChanged.emit({name:"confirmClosingDocument",oldValue:e,newValue:t})}}get lastModifiedCheckMargin(){return this._lastModifiedCheckMargin}set lastModifiedCheckMargin(t){if(this._lastModifiedCheckMargin!==t){const e=this._lastModifiedCheckMargin;this._lastModifiedCheckMargin=t,this._contexts.forEach((e=>{e.lastModifiedCheckMargin=t})),this._stateChanged.emit({name:"lastModifiedCheckMargin",oldValue:e,newValue:t})}}get renameUntitledFileOnSave(){return this._renameUntitledFileOnSave}set renameUntitledFileOnSave(t){if(this._renameUntitledFileOnSave!==t){const e=this._renameUntitledFileOnSave;this._renameUntitledFileOnSave=t,this._stateChanged.emit({name:"renameUntitledFileOnSave",oldValue:e,newValue:t})}}get stateChanged(){return this._stateChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,d.Signal.clearData(this),this._contexts.forEach((t=>this._widgetManager.closeWidgets(t))),this._widgetManager.dispose(),this._contexts.length=0)}cloneWidget(t){return this._widgetManager.cloneWidget(t)}closeAll(){return Promise.all(this._contexts.map((t=>this._widgetManager.closeWidgets(t)))).then((()=>{}))}closeFile(t){const e=this._contextsForPath(t).map((t=>this._widgetManager.closeWidgets(t)));return Promise.all(e).then((t=>{}))}contextForWidget(t){return this._widgetManager.contextForWidget(t)}copy(t,e){return this.services.contents.copy(t,e)}createNew(t,e="default",s){return this._createOrOpenDocument("create",t,e,s)}deleteFile(t){return this.services.sessions.stopIfNeeded(t).then((()=>this.services.contents.delete(t))).then((()=>(this._contextsForPath(t).forEach((t=>this._widgetManager.deleteWidgets(t))),Promise.resolve(void 0))))}duplicate(t){const e=a.PathExt.dirname(t);return this.services.contents.copy(t,e)}findWidget(t,e="default"){const s=a.PathExt.normalize(t);let i=[e];if("default"===e){const t=this.registry.defaultWidgetFactory(s);if(!t)return;i=[t.name]}else null===e&&(i=this.registry.preferredWidgetFactories(s).map((t=>t.name)));for(const t of this._contextsForPath(s))for(const e of i)if(null!==e){const s=this._widgetManager.findWidget(t,e);if(s)return s}}newUntitled(t){return"file"===t.type&&(t.ext=t.ext||".txt"),this.services.contents.newUntitled(t)}open(t,e="default",s,i){return this._createOrOpenDocument("open",t,e,s,i)}openOrReveal(t,e="default",s,i){const n=this.findWidget(t,e);return n?(this._opener.open(n,{type:e,...i}),n):this.open(t,e,s,null!=i?i:{})}overwrite(t,e){const s=`${e}.${l.UUID.uuid4()}`,i=()=>this.rename(s,e);return this.rename(t,s).then((()=>this.deleteFile(e))).then(i,i)}rename(t,e){return this.services.contents.rename(t,e)}_findContext(t,e){const s=this.services.contents.normalize(t);return(0,p.sE)(this._contexts,(t=>t.path===s&&t.factoryName===e))}_contextsForPath(t){const e=this.services.contents.normalize(t);return this._contexts.filter((t=>t.path===e))}_createContext(t,e,s){const i=new _({opener:(t,e)=>{this._widgetManager.adoptWidget(i,t),this._opener.open(t,e)},manager:this.services,factory:e,path:t,kernelPreference:s,setBusy:this._setBusy,sessionDialogs:this._dialogs,lastModifiedCheckMargin:this._lastModifiedCheckMargin,translator:this.translator}),n=new m({context:i,isConnectedCallback:this._isConnectedCallback,saveInterval:this.autosaveInterval});return f.saveHandlerProperty.set(i,n),i.ready.then((()=>{this.autosave&&n.start()})),i.disposed.connect(this._onContextDisposed,this),this._contexts.push(i),i}_onContextDisposed(t){p.RO.removeFirstOf(this._contexts,t)}_widgetFactoryFor(t,e){const{registry:s}=this;if("default"===e){const i=s.defaultWidgetFactory(t);if(!i)return;e=i.name}return s.getWidgetFactory(e)}_createOrOpenDocument(t,e,s="default",i,n){const a=this._widgetFactoryFor(e,s);if(!a)return;const o=a.modelName||"text",r=this.registry.getModelFactory(o);if(!r)return;const h=this.registry.getKernelPreference(e,a.name,i);let l,c=Promise.resolve(void 0);if("open"===t)l=this._findContext(e,r.name)||null,l||(l=this._createContext(e,r,h),c=this._when.then((()=>l.initialize(!1))));else{if("create"!==t)throw new Error(`Invalid argument 'which': ${t}`);l=this._createContext(e,r,h),c=this._when.then((()=>l.initialize(!0)))}const d=this._widgetManager.createWidget(a,l);return this._opener.open(d,{type:a.name,...n}),c.catch((t=>{console.error(`Failed to initialize the context with '${r.name}' for ${e}`,t),d.close()})),d}_onActivateRequested(t,e){this._activateRequested.emit(e)}_onWidgetStateChanged(t,e){"confirmClosingDocument"===e.name&&this._stateChanged.emit(e)}}!function(t){t.saveHandlerProperty=new g.AttachedProperty({name:"saveHandler",create:()=>{}})}(f||(f={}))},50705:(t,e,s)=>{s.d(e,{q:()=>h});var i=s(48425),n=s(68471),a=s(55616),o=s(56769);function r(t){return o.createElement(n.Jy,{source:t.name,title:t.fullPath})}class h extends a.UB{constructor(t){super(new h.Model(t.docManager)),this.node.title=this.model.path}render(){return o.createElement(r,{fullPath:this.model.path,name:this.model.name})}}!function(t){class e extends a.I_{constructor(t){super(),this._onTitleChange=t=>{const e=this._getAllState();this._name=t.label,this._triggerChange(e,this._getAllState())},this._onPathChange=(t,e)=>{const s=this._getAllState();this._path=e,this._name=i.PathExt.basename(e),this._triggerChange(s,this._getAllState())},this._path="",this._name="",this._widget=null,this._docManager=t}get path(){return this._path}get name(){return this._name}get widget(){return this._widget}set widget(t){const e=this._widget;if(null!==e){const t=this._docManager.contextForWidget(e);t?t.pathChanged.disconnect(this._onPathChange):e.title.changed.disconnect(this._onTitleChange)}const s=this._getAllState();if(this._widget=t,null===this._widget)this._path="",this._name="";else{const t=this._docManager.contextForWidget(this._widget);t?(this._path=t.path,this._name=i.PathExt.basename(t.path),t.pathChanged.connect(this._onPathChange)):(this._path="",this._name=this._widget.title.label,this._widget.title.changed.connect(this._onTitleChange))}this._triggerChange(s,this._getAllState())}_getAllState(){return[this._path,this._name]}_triggerChange(t,e){t[0]===e[0]&&t[1]===e[1]||this.stateChanged.emit(void 0)}}t.Model=e}(h||(h={}))},49486:(t,e,s)=>{s.d(e,{N:()=>h});var i=s(68471),n=s(18168),a=s(55616),o=s(56769);function r(t){return o.createElement(i.Jy,{source:t.fileStatus})}class h extends a.UB{constructor(t){super(new h.Model(t.docManager));const e=(t.translator||n.Sr).load("jupyterlab");this._statusMap={completed:e.__("Saving completed"),started:e.__("Saving started"),failed:e.__("Saving failed")}}render(){return null===this.model||null===this.model.status?null:o.createElement(r,{fileStatus:this._statusMap[this.model.status]})}}!function(t){class e extends a.I_{constructor(t){super(),this._onStatusChange=(t,e)=>{this._status=e,"completed"===this._status?(setTimeout((()=>{this._status=null,this.stateChanged.emit(void 0)}),2e3),this.stateChanged.emit(void 0)):this.stateChanged.emit(void 0)},this._status=null,this._widget=null,this._status=null,this.widget=null,this._docManager=t}get status(){return this._status}get widget(){return this._widget}set widget(t){var e,s;const i=this._widget;if(null!==i){const t=this._docManager.contextForWidget(i);t?t.saveState.disconnect(this._onStatusChange):(null===(e=this._widget.content)||void 0===e?void 0:e.saveStateChanged)&&this._widget.content.saveStateChanged.disconnect(this._onStatusChange)}if(this._widget=t,null===this._widget)this._status=null;else{const t=this._docManager.contextForWidget(this._widget);t?t.saveState.connect(this._onStatusChange):(null===(s=this._widget.content)||void 0===s?void 0:s.saveStateChanged)&&this._widget.content.saveStateChanged.connect(this._onStatusChange)}}}t.Model=e}(h||(h={}))},58722:(t,e,s)=>{s.d(e,{C:()=>a,T:()=>n});var i=s(47963);const n=new i.Token("@jupyterlab/docmanager:IDocumentManager","A service for the manager for all\n  documents used by the application. Use this if you want to open and close documents,\n  create and delete files, and otherwise interact with the file system."),a=new i.Token("@jupyterlab/docmanager:IDocumentWidgetOpener","A service to open a widget.")}}]);